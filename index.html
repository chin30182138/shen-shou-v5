<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>ç¥ç¸ä¸ƒåäºŒå‹äººæ ¼ï½œV7 å•å·ï¼‹å ±è¡¨ï¼‹ç‰¹æ•ˆ</title>
  <meta name="description" content="30é¡Œé‡è¡¨ï½œå…­ç¸é›·é”åœ–ï½œä¸»ç¥ç¸/é›™ç¸å‹ï½œä¸‰æ¬„å»ºè­°ï½œåˆ†æå¸«å¡ï½œé½’è¼ªè¨­å®šï½œèƒŒæ™¯ç‰¹æ•ˆï½œåˆ—å°/PNGï½œè·¯å¾‘è‡ªå‹•åµæ¸¬"/>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <style>
    :root{--brand:#B6822B;--ink:#1f2937}
    body{margin:0;overflow-x:hidden;background:linear-gradient(135deg,#f6f7fb,#ffffff);transition:background 0.6s ease,opacity .3s ease}
    .card{background:#fff;border:1px solid #e5e7eb;border-radius:18px;box-shadow:0 6px 20px rgba(0,0,0,.06)}
    .brand{color:var(--brand)} .brand-bg{background:var(--brand)}
    .slider{accent-color:var(--brand)}
    canvas#bgfx{position:fixed;inset:0;z-index:-1;pointer-events:none}
    #gear{position:fixed;top:14px;right:14px;z-index:50;background:var(--brand);color:#fff;border-radius:9999px;padding:10px;box-shadow:0 6px 16px rgba(0,0,0,.2)}
    #panel{position:fixed;top:0;right:0;height:100%;width:340px;background:#fff;border-left:1px solid #e5e7eb;box-shadow:-6px 0 20px rgba(0,0,0,.12);transform:translateX(100%);transition:.35s;z-index:40}
    #panel.open{transform:translateX(0)}
    #panel .sec{padding:14px 16px;border-bottom:1px dashed #eee}
    #panel label{font-size:12px;color:#64748b}
    @media print{
      #gear,#panel,.no-print,#questionWrap{display:none !important}
      body{background:#fff !important}
      .card{box-shadow:none}
    }
  </style>
</head>
<body id="bodyRoot" class="text-slate-800">
  <!-- èƒŒæ™¯ç‰¹æ•ˆ -->
  <canvas id="bgfx"></canvas>

  <!-- é½’è¼ª -->
  <button id="gear" title="åˆ†æå¸«è¨­å®š" class="hover:rotate-90 transition-transform">âš™ï¸</button>

  <!-- å´é‚Šè¨­å®šé¢æ¿ -->
  <aside id="panel">
    <div class="sec">
      <h2 class="text-lg font-bold">åˆ†æå¸«è¨­å®š</h2>
      <div class="mt-2 grid grid-cols-2 gap-2 text-sm">
        <div><label>å§“å</label><input id="fName" class="w-full border rounded px-2 py-1" value="æ—è”šé’ é˜¿é’å¸«"></div>
        <div><label>è¯çµ¡</label><input id="fContact" class="w-full border rounded px-2 py-1" value="LINEï¼š@chin573365"></div>
      </div>
      <div class="mt-2 text-sm">
        <label>è‡ªæˆ‘ä»‹ç´¹</label>
        <textarea id="fBio" rows="2" class="w-full border rounded px-2 py-1">ä»¥é‡‘éŒ¢å¦ç‚ºæ ¸å¿ƒï¼Œèåˆä¸­é†«äº”è¡Œï¼ŒæŒ‡å¼•äººç”Ÿæ–¹å‘ã€‚</textarea>
      </div>
      <div class="mt-2 text-sm">
        <label>ä¸Šå‚³åˆ†æå¸« QR</label>
        <input id="fQR" type="file" accept="image/*" class="w-full border rounded px-2 py-1">
      </div>
    </div>

    <div class="sec">
      <h3 class="font-bold">èƒŒæ™¯æ¨£å¼</h3>
      <div class="mt-1 text-sm">
        <label>é è¨­é¢¨æ ¼</label>
        <select id="bgStyle" class="w-full border rounded px-2 py-1">
          <option value="A" selected>é‡‘æ£•ä»™æ°£ï¼ˆå“ç‰Œï¼‰</option>
          <option value="B">è—ç´«å¤œç©º</option>
          <option value="C">ç«é³³å…‰ç„°</option>
          <option value="D">ç„æ­¦æ°´æµ</option>
          <option value="E">ç™½ç°ç¦ªéœ§</option>
          <option value="F">è‡ªè¨‚é›™è‰²</option>
        </select>
      </div>
      <div id="customColors" class="hidden mt-2 grid grid-cols-2 gap-2 text-sm">
        <div><label>é¡è‰²1</label><input type="color" id="c1" class="w-full h-9 border rounded" value="#B6822B"></div>
        <div><label>é¡è‰²2</label><input type="color" id="c2" class="w-full h-9 border rounded" value="#ffffff"></div>
      </div>
      <div class="mt-2 text-sm">
        <label>èƒŒæ™¯åœ–ç‰‡</label>
        <input id="bgImg" type="file" accept="image/*" class="w-full border rounded px-2 py-1">
      </div>
      <div class="mt-2 text-sm">
        <label>èƒŒæ™¯é€æ˜åº¦</label>
        <input id="bgOpacity" type="range" min="0.2" max="1" step="0.05" value="0.9" class="w-full">
      </div>
    </div>

    <div class="sec">
      <h3 class="font-bold">å…‰é»ç‰¹æ•ˆ</h3>
      <div class="mt-1 text-sm">
        <label>æ•ˆæœ</label>
        <select id="fxType" class="w-full border rounded px-2 py-1">
          <option value="1">æŸ”å’Œå…‰æšˆ</option>
          <option value="2" selected>é“æ°£æµè½‰</option>
          <option value="3">æ˜Ÿç©ºé–ƒçˆ</option>
          <option value="0">é—œé–‰</option>
        </select>
      </div>
    </div>

    <div class="sec">
      <button id="btnSave" class="w-full bg-amber-600 text-white py-2 rounded">å„²å­˜è¨­å®š</button>
    </div>
  </aside>

  <main class="max-w-6xl mx-auto p-4 sm:p-6 relative">
    <!-- é é¦– -->
    <header class="mb-4 sm:mb-6">
      <div class="flex items-center justify-between gap-3">
        <div class="flex items-center gap-3">
          <img data-logo alt="ä»™äººæŒ‡è·¯ Logo" class="h-10 w-auto rounded">
          <div>
            <h1 class="text-2xl sm:text-3xl font-extrabold brand">ç¥ç¸ä¸ƒåäºŒå‹äººæ ¼ æ¸¬é©—ï¼‹æ™ºèƒ½å ±è¡¨</h1>
            <p class="text-slate-600 text-sm">30é¡Œé‡è¡¨ãƒ»å…­ç¸é›·é”åœ–ãƒ»ä¸»ç¥ç¸/é›™ç¸å‹ãƒ»ä¸‰æ¬„å»ºè­°ãƒ»åˆ†æå¸«å¡ãƒ»åˆ—å°/PNG</p>
          </div>
        </div>
        <div class="no-print">
          <button id="btnToggleQ" class="px-3 py-2 border rounded">é¡¯ç¤º/éš±è—å•å·</button>
        </div>
      </div>
    </header>

    <!-- å•å· -->
    <section id="questionWrap" class="no-print">
      <section class="card p-4 sm:p-5 mb-4">
        <div class="flex flex-col lg:flex-row justify-between items-start lg:items-center gap-3">
          <div class="text-sm text-slate-600">é‡è¡¨èªªæ˜ï¼š1ï¼å®Œå…¨ä¸åŒæ„ ï½œ 3ï¼æ™®é€š ï½œ 5ï¼éå¸¸åŒæ„</div>
          <div class="flex flex-wrap gap-2">
            <button id="btnFill3" class="px-3 py-2 text-sm border rounded">å…¨éƒ¨å¡«3</button>
            <button id="btnClear" class="px-3 py-2 text-sm border rounded">æ¸…ç©º</button>
            <button id="btnShuffle" class="px-3 py-2 text-sm border rounded">éš¨æ©Ÿé¡Œåº</button>
          </div>
        </div>
      </section>

      <form id="form" class="card p-4 sm:p-5">
        <ol id="qList" class="space-y-3"></ol>
        <div class="mt-5 flex gap-3 flex-wrap">
          <button type="submit" class="brand-bg text-white px-5 py-3 rounded-xl font-semibold shadow">é€å‡ºæ¸¬é©—</button>
        </div>
      </form>
    </section>

    <!-- çµæœ ï¼‹ å ±è¡¨ -->
    <section id="result" class="mt-6 grid lg:grid-cols-2 gap-4">
      <!-- é›·é”åœ– -->
      <div class="card p-4 sm:p-5">
        <h2 class="text-lg font-bold mb-3">å…­ç¸èƒ½é‡é›·é”åœ–</h2>
        <canvas id="radar"></canvas>
        <div class="text-xs text-slate-500 mt-2">è‹¥å…©å€‹æœ€é«˜åˆ†å·® â‰¤ 1ï¼Œè¦–ç‚ºã€Œé›™ç¸å‹ã€ã€‚</div>
        <div class="flex flex-wrap gap-2 mt-4 no-print">
          <button id="btnPNG" class="px-4 py-2 bg-amber-600 text-white rounded-lg">ä¸‹è¼‰çµæœå¡ PNG</button>
          <button id="btnPrint" class="px-4 py-2 border rounded-lg">åˆ—å°å ±è¡¨</button>
        </div>
      </div>

      <!-- å ±è¡¨å¡ -->
      <div class="card p-4 sm:p-5" id="resultCard">
        <div class="flex items-center justify-between">
          <h2 class="text-lg font-bold">ä¸»ç¥ç¸çµæœèˆ‡ä¸‰æ¬„å»ºè­°</h2>
          <img data-logo alt="Logo" class="h-8 w-auto">
        </div>
        <div class="grid grid-cols-3 gap-3 items-start mt-2">
          <div id="beastSVG" class="w-full aspect-square"></div>
          <div class="col-span-2">
            <div id="mainBeastTitle" class="text-base font-semibold brand"></div>
            <div id="dualHint" class="mt-1 text-sm text-slate-600"></div>
            <div id="mainBeastSummary" class="mt-2 text-sm"></div>
          </div>
        </div>
        <hr class="my-3"/>
        <div id="adviceCols" class="grid md:grid-cols-3 gap-3 text-sm"></div>
        <hr class="my-3"/>
        <h3 class="text-base mb-1">å…­ç¸åˆ†æ•¸</h3>
        <div id="scoreList" class="grid grid-cols-2 sm:grid-cols-3 gap-x-4 gap-y-1 text-sm"></div>

        <hr class="my-3"/>
        <!-- åˆ†æå¸«å¡ -->
        <div class="grid md:grid-cols-3 gap-3">
          <div class="md:col-span-2">
            <h3 class="text-base font-bold mb-1">ğŸ‘¤ åˆ†æå¸«è³‡æ–™</h3>
            <div class="grid sm:grid-cols-2 gap-2">
              <div><div class="text-xs text-slate-500">å§“å</div><div id="vName" class="font-medium">æ—è”šé’ é˜¿é’å¸«</div></div>
              <div><div class="text-xs text-slate-500">è¯çµ¡</div><div id="vContact" class="font-medium">LINEï¼š@chin573365</div></div>
            </div>
            <div class="mt-2">
              <div class="text-xs text-slate-500">è‡ªæˆ‘ä»‹ç´¹</div>
              <div id="vBio" class="text-sm">ä»¥é‡‘éŒ¢å¦ç‚ºæ ¸å¿ƒï¼Œèåˆä¸­é†«äº”è¡Œï¼ŒæŒ‡å¼•äººç”Ÿæ–¹å‘ã€‚</div>
            </div>
          </div>
          <div class="flex items-center justify-center">
            <div class="text-center">
              <div class="text-xs text-slate-500 mb-1">åˆ†æå¸«å€‹äºº QR</div>
              <img id="vQR" src="" alt="åˆ†æå¸«QR" class="h-28 w-28 object-contain border rounded mx-auto"/>
            </div>
          </div>
        </div>

        <hr class="my-3"/>
        <div class="grid grid-cols-3 items-center">
          <div class="text-xs text-slate-500">ä»™äººæŒ‡è·¯å åœç ”ç©¶å­¸æœƒ</div>
          <div class="text-center text-xs brand">æœ¬åˆ†æå ±è¡¨ç”±ä»™äººæŒ‡è·¯å åœç ”ç©¶å­¸æœƒæˆæ¬Šåˆ†æå¸«å‡ºå…·</div>
          <div class="text-right">
            <img data-qr alt="LINE QR" class="h-16 w-16 inline-block border rounded"/>
          </div>
        </div>
      </div>
    </section>

    <footer class="text-center text-xs text-slate-500 mt-8">
      Â© 2025 ä»™äººæŒ‡è·¯å åœç ”ç©¶å­¸æœƒï½œæ¸¬é©—åƒ…ä¾›è¦ºå¯Ÿèˆ‡æ•™å­¸ç”¨é€”
    </footer>
  </main>

<script>
/* ---------------- è·¯å¾‘è‡ªå‹•åµæ¸¬ï¼ˆæ”¯æ´ shen-shou-v5/v6/v7â€¦ï¼‰ ---------------- */
(function autoAssets(){
  const base = window.location.pathname.split('/').filter(Boolean)[0] ? ('/' + window.location.pathname.split('/').filter(Boolean)[0]) : '';
  document.querySelectorAll('[data-logo]').forEach(el=> el.src = `${base}/img/logo.png`);
  document.querySelectorAll('[data-qr]').forEach(el=> el.src = `${base}/img/line-qr.jpg`);
})();

/* ---------------- é¡Œåº«ï¼ˆ6ç¸ Ã— 5é¡Œ = 30é¡Œï¼‰ ---------------- */
const BANK = [
  {t:"æˆ‘å¸¸æœ‰çªå¦‚å…¶ä¾†çš„éˆæ„Ÿä¸¦æƒ³ç«‹å³å˜—è©¦ã€‚",b:"é’é¾"},{t:"æˆ‘å–œæ­¡æ‰“ç ´å¸¸è¦å°‹æ‰¾æ–°æ–¹æ³•ã€‚",b:"é’é¾"},{t:"é‡é˜»åŠ›æ™‚æˆ‘æœƒéˆæ´»è½‰å‘ã€‚",b:"é’é¾"},{t:"æˆ‘å¯Œæƒ³åƒåŠ›ï¼Œå–œæ­¡å‰µæ–°æ€è€ƒã€‚",b:"é’é¾"},{t:"æˆ‘ç†±æ„›æ¢ç´¢æœªçŸ¥äº‹ç‰©ã€‚",b:"é’é¾"},
  {t:"æˆ‘å–œæ­¡åœ¨äººç¾¤ä¸­è¡¨é”è‡ªå·±ã€‚",b:"æœ±é›€"},{t:"æˆ‘ç”¨æƒ…ç·’å¸¶å‹•ä»–äººã€‚",b:"æœ±é›€"},{t:"åˆ¥äººçš„åæ‡‰æœƒå½±éŸ¿æˆ‘ã€‚",b:"æœ±é›€"},{t:"æˆ‘æ“…é•·èªªæœèˆ‡æ¼”èªªã€‚",b:"æœ±é›€"},{t:"æˆ‘é‡è¦–è¢«å‚¾è½èˆ‡é—œæ³¨ã€‚",b:"æœ±é›€"},
  {t:"æˆ‘å–œæ­¡æŒ‰è¨ˆç•«è¡Œäº‹ã€‚",b:"å‹¾é™³"},{t:"æˆ‘é‡è¦–å®‰å…¨æ„Ÿèˆ‡ç©©å®šã€‚",b:"å‹¾é™³"},{t:"æˆ‘è²¬ä»»æ„Ÿå¼·ã€‚",b:"å‹¾é™³"},{t:"æˆ‘å‚¾å‘ç¶­æŒç¾ç‹€ã€‚",b:"å‹¾é™³"},{t:"æˆ‘æ³¨é‡ç´°ç¯€èˆ‡ç¨‹åºã€‚",b:"å‹¾é™³"},
  {t:"æˆ‘å°ä»–äººæƒ…ç·’å¾ˆæ•æ„Ÿã€‚",b:"è£è›‡"},{t:"æˆ‘æ“…é•·è§€å¯Ÿèˆ‡å‚¾è½ã€‚",b:"è£è›‡"},{t:"æˆ‘æ€è€ƒäº‹æƒ…æœƒè€ƒé‡æ™‚æ©Ÿèˆ‡äººå¿ƒã€‚",b:"è£è›‡"},{t:"æˆ‘å¸¸æ€è€ƒèƒŒå¾Œçš„å‹•æ©Ÿã€‚",b:"è£è›‡"},{t:"æˆ‘å–„æ–¼å”èª¿ä¸åŒè§€é»ã€‚",b:"è£è›‡"},
  {t:"æˆ‘è¬›æ±‚æ•ˆç‡èˆ‡çµæœã€‚",b:"ç™½è™"},{t:"æˆ‘æœƒä¸»å‹•åšæ±ºç­–ã€‚",b:"ç™½è™"},{t:"æˆ‘ä»¥æ•¸æ“šèˆ‡æˆæœç‚ºå°å‘ã€‚",b:"ç™½è™"},{t:"æˆ‘é¡˜æ„æ‰¿æ“”å£“åŠ›ä»¥å®Œæˆä»»å‹™ã€‚",b:"ç™½è™"},{t:"æˆ‘åå¥½æ˜ç¢ºçš„è¦ç¯„èˆ‡æ¨™æº–ã€‚",b:"ç™½è™"},
  {t:"æˆ‘å–œæ­¡ç¨è‡ªæ€è€ƒã€‚",b:"ç„æ­¦"},{t:"æˆ‘å‚¾å‘è¬¹æ…è©•ä¼°å¾Œè¡Œå‹•ã€‚",b:"ç„æ­¦"},{t:"æˆ‘æ“…é•·è¦åŠƒé•·é ç›®æ¨™ã€‚",b:"ç„æ­¦"},{t:"æˆ‘é‡è¦–é‚è¼¯èˆ‡åˆ†æã€‚",b:"ç„æ­¦"},{t:"æˆ‘ç¿’æ…£å†·éœçœ‹å¾…å•é¡Œã€‚",b:"ç„æ­¦"}
];

/* ---------------- å»ºè­°åº«ï¼ˆè·å ´ï¼æ„Ÿæƒ…ï¼é¤Šç”Ÿï¼‰ ---------------- */
const ADVICES = {
  é’é¾:{summary:"ä½ çš„æœ¨è¡Œèƒ½é‡æ—ºç››ï¼Œæ“…é•·æ‰“ç ´æ¡†æ¶ã€æ¿€ç™¼æ–°è·¯ã€‚é—œéµåœ¨æ–¼èšç„¦èˆ‡è½åœ°ã€‚",
    workplace:["æŠŠå‰µæ„åŒ–ç‚º 1 å€‹ã€æœ¬æœˆ MVP å°å°ˆæ¡ˆã€ä¸¦è¨­å®šæ™‚ç¨‹è¡¨ã€‚","æ‰¾ 1 ä½ã€å‹¾é™³å¤¥ä¼´ã€åšæµç¨‹æŠŠé—œã€‚","ææ¡ˆå‰å…ˆåšä¸€é ä¼åŠƒåœ–ã€‚"],
    love:["é‚€ä¼´ä¾¶åƒèˆ‡ä½ çš„æ–°é»å­ã€‚","ç·´ç¿’ 2/3 è½ã€1/3 èªªã€‚","å›ºå®šã€å„€å¼æ„Ÿæ™‚åˆ»ã€é™ä½å¿½å†·å¿½ç†±ã€‚"],
    health:["æ·±å‘¼å¸ï¼‹å¿«èµ° 20 åˆ†é˜ã€‚","å¤šç¶ æ¤é£Ÿï¼Œå°‘é…’ç†¬å¤œã€‚","æ›¸å¯«å‚¾å€’ï¼Œæ¸…é™¤æœªç«Ÿäº‹é …ã€‚"]},
  æœ±é›€:{summary:"å¤–æ”¾ç«è¡Œå¼·ï¼Œæ“…é•·æºé€šå¸¶å‹•æ°£æ°›ã€‚é—œéµåœ¨æ–¼ç¯€å¥èˆ‡ç•Œç·šã€‚",
    workplace:["åˆ— 3 é»æ ¸å¿ƒè¨Šæ¯é¿å…å»¶ä¼¸ã€‚","è‚¯å®šâ†’å»ºè­°â†’æ‰¿è«¾ä¸‰æ­¥é©Ÿã€‚","æ±ºç­–å‰è¨­å†·å»æ™‚é–“ã€‚"],
    love:["ç”¨ã€æˆ‘è¨Šæ¯ã€æè¿°æ„Ÿå—ã€‚","å®‰æ’å…±åŒç¤¾äº¤æ´»å‹•ã€‚","æƒ…ç·’é«˜å³°å…ˆæš«åœ 10 åˆ†é˜ã€‚"],
    health:["åš 4-7-8 å‘¼å¸æ³•ç©©å®šã€‚","å°‘è¾›è¾£å’–å•¡å› ã€‚","æ¯é€± 2 æ¬¡ç·©å’Œæœ‰æ°§/ç‘œä¼½ã€‚"]},
  å‹¾é™³:{summary:"åœŸè¡Œæ²‰ç©©å¯é ï¼Œæ“…é•·æµç¨‹èˆ‡é¢¨éšªæ§ç®¡ã€‚é—œéµåœ¨æ–¼æ“´å¼µèˆ’é©åœˆã€‚",
    workplace:["æ¯å­£ä¸»å‹•æ 1 é …æµç¨‹å„ªåŒ–ã€‚","èˆ‡é’é¾çµå°è®“æ–°é»å­è½åœ°ã€‚","ç•ªèŒ„é˜åˆ‡åˆ†å¾…è¾¦ã€‚"],
    love:["ä¸»å‹•èªªå‡ºä½ çš„éœ€è¦ã€‚","æ¯æœˆå®‰æ’æ–°é®®é«”é©—ç´„æœƒã€‚","ç·´ç¿’è¡¨é”è®šç¾ã€‚"],
    health:["è„¾èƒƒèª¿ç†ï¼šæ—©ç¡æ—©èµ·ã€‚","å¤šå—ç“œå±±è—¥è–ä»ï¼Œå°‘å†°å†·ã€‚","æ¯æ—¥ 10 åˆ†é˜è…¹å¼å‘¼å¸ã€‚"]},
  è£è›‡:{summary:"é«˜æ•è¦ºå¯Ÿèˆ‡äººå¿ƒæ´æ‚‰ï¼Œå–„æ–¼æŠ“æ™‚æ©Ÿã€‚é—œéµåœ¨æ–¼æ­¢è§€èˆ‡è¡Œå‹•ã€‚",
    workplace:["æŠŠæ´å¯Ÿå¯«æˆæ±ºç­–å‚™å¿˜éŒ„ã€‚","è¨­å®š 72 å°æ™‚å…§æœ€å°è¡Œå‹•ã€‚","å»ºç«‹è­°é¡Œç•Œç·šï¼Œå¿…è¦æ™‚è½‰äº¤ã€‚"],
    love:["èªªå‡ºæ“”å¿ƒè€Œéè¿´é¿ã€‚","ç”¨è«‹æ±‚ä»£æ›¿è©¦æ¢ã€‚","éœå¿ƒæ•£æ­¥å®‰å®šé«˜æ•åº¦ã€‚"],
    health:["è‚Œè‚‰æ”¾é¬†/ç‘œä¼½å°¼å¾·æ‹‰ã€‚","èŠèŠ±æ±ºæ˜å­æ¸…è‚æ˜ç›®ã€‚","æ¸›å°‘é•·æ™‚é–“è¢å¹•ã€‚"]},
  ç™½è™:{summary:"æœæ±ºè¿…é€Ÿèˆ‡çµæœå°å‘ã€‚é—œéµåœ¨æ–¼åŒç†èˆ‡è€å¿ƒã€‚",
    workplace:["æ¯æ¬¡æŒ‡ä»¤é™„å¸¶ã€ç‚ºä»€éº¼ã€ã€‚","è¨­ç½®ç·©è¡æ—¥é¿å…æµå¤±ã€‚","æˆ°è¡“æœƒï¼‹å›é¡§æœƒå…±å­˜ã€‚"],
    love:["ä»¥é—œå¿ƒå¥é–‹é ­ã€‚","æ¯é€± 1 æ¬¡ç„¡æ‰‹æ©Ÿæ™šé¤ã€‚","å¤šè‚¯å®šèªèˆ‡è§¸ç¢°ã€‚"],
    health:["èƒ¸èƒŒä¼¸å±•ï¼‹æ·±å‘¼å¸ã€‚","ç™½è˜¿è””/æ¢¨/æ‡æ·æ½¤è‚ºã€‚","ä¸­ä½å¼·åº¦æœ‰æ°§æ”¾æ…¢äº¤æ„Ÿã€‚"]},
  ç„æ­¦:{summary:"å†·éœç†æ€§ã€é•·é è¦–è§’ã€‚é—œéµåœ¨æ–¼è¼¸å‡ºèˆ‡äº’ä¿¡ã€‚",
    workplace:["ç­–ç•¥ç•«æˆä¸€é è·¯ç·šåœ–ã€‚","ç‚ºç ”ç©¶è¨­å®šäº¤ä»˜ç‰©ã€‚","ç·´ç¿’å³å¸­ç°¡å ±ã€‚"],
    love:["10 åˆ†é˜æƒ…æ„Ÿæ—¥è¨˜ã€‚","æ¯é€±è­°é¡Œæ™‚é–“ã€‚","å…±åŒè¨ˆç•«å¢é€²é€£çµã€‚"],
    health:["è¦å¾‹ä½œæ¯èˆ‡è¶³æµ´æš–è…ã€‚","é»‘èŠéº»/å±±è—¥/æ¸æã€‚","å¤ªæ¥µæˆ–å¹³è¡¡è¨“ç·´ã€‚"]}
};

/* ---------------- å•å·æ¸²æŸ“ ---------------- */
const qList = document.getElementById('qList');
function renderQuestions(){
  qList.innerHTML = '';
  BANK.forEach((q,i)=>{
    qList.innerHTML += `
      <li class="p-3 border rounded-xl">
        <p>${i+1}. ${q.t} <span class="text-xs text-slate-400">ï¼ˆ${q.b}ï¼‰</span></p>
        <input type="range" min="1" max="5" value="3" id="q${i}" class="w-full slider">
      </li>`;
  });
}
renderQuestions();

/* ---------------- å•å·æ“ä½œ ---------------- */
document.getElementById('btnFill3').onclick = ()=> document.querySelectorAll('.slider').forEach(s=>s.value=3);
document.getElementById('btnClear').onclick = ()=> document.querySelectorAll('.slider').forEach(s=>s.value=3);
document.getElementById('btnShuffle').onclick = ()=>{
  BANK.sort(()=>Math.random()-0.5);
  renderQuestions();
};

/* ---------------- çµæœè¨ˆç®— ---------------- */
function calcScores(){
  const scores={é’é¾:0,æœ±é›€:0,å‹¾é™³:0,è£è›‡:0,ç™½è™:0,ç„æ­¦:0};
  BANK.forEach((q,i)=>{ scores[q.b] += parseInt(document.getElementById(`q${i}`).value||'3',10); });
  return scores;
}
function summarize(scores){
  const arr=Object.entries(scores).sort((a,b)=>b[1]-a[1]);
  const top=arr[0], second=arr[1];
  const dual = (top[1]-second[1] <= 1) ? [top[0], second[0]] : null;
  return {top:top[0], dual, ranking:arr};
}

/* ---------------- é›·é”åœ– ---------------- */
let radarChart=null;
function drawRadar(scores){
  const ctx=document.getElementById('radar');
  if(radarChart) radarChart.destroy();
  radarChart = new Chart(ctx,{
    type:'radar',
    data:{labels:Object.keys(scores),datasets:[{
      label:'å…­ç¸èƒ½é‡',
      data:Object.values(scores),
      backgroundColor:'rgba(182,130,43,0.15)',
      borderColor:'rgba(182,130,43,1)',
      pointBackgroundColor:'rgba(182,130,43,1)'
    }]},
    options:{scales:{r:{suggestedMin:0,suggestedMax:25,ticks:{stepSize:5}}},plugins:{legend:{display:false}}}
  });
}

/* ---------------- å ±è¡¨æ¸²æŸ“ ---------------- */
function beastSVG(name){
  const stroke='#B6822B', fill='none';
  const base=(d)=>`<svg viewBox='0 0 100 100' class='w-full h-auto' xmlns='http://www.w3.org/2000/svg'>
    <defs><radialGradient id='g' cx='50%' cy='50%' r='60%'>
      <stop offset='0%' stop-color='rgba(182,130,43,0.25)'/><stop offset='100%' stop-color='rgba(182,130,43,0)'/></radialGradient></defs>
    <rect width='100' height='100' fill='url(#g)'/>${d}</svg>`;
  const s=(d)=>`<path d='${d}' fill='${fill}' stroke='${stroke}' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'/>`;
  switch(name){
    case 'é’é¾': return base(s("M15 60 C25 40, 45 35, 55 45 C65 55, 75 35, 85 45 M45 45 q5 -12 16 -10 m-6 6 l6 4 m-36 20 q10 -6 18 2 m12 -2 q8 -6 18 2")+s("M30 70 q10 8 20 0 q10 -8 20 0"));
    case 'æœ±é›€': return base(s("M20 60 q15 -30 30 -30 q15 0 30 30 M50 30 l0 12 M35 55 q15 -8 30 0 M25 62 q10 8 25 8 q15 0 25 -8"));
    case 'å‹¾é™³': return base(s("M20 70 h60 v-20 h-60 v20 z M30 50 v-10 h40 v10 M35 65 h10 M55 65 h10"));
    case 'è£è›‡': return base(s("M20 70 q20 -30 40 -10 q10 8 20 -2 q-10 20 -30 10 q-10 -6 -30 2 M60 48 q6 -6 12 0"));
    case 'ç™½è™': return base(s("M20 65 q15 -20 30 -20 q15 0 30 20 M30 60 h40 M35 70 h30 M38 52 l4 6 M58 52 l-4 6"));
    case 'ç„æ­¦': return base(s("M30 65 q20 15 40 0 q5 -12 -15 -22 q-20 10 -25 22 M55 50 q10 -8 20 2 M25 55 q-8 -6 -10 6"));
    default: return base('');
  }
}
function renderReport(summary, scores){
  const info=ADVICES[summary.top];
  document.getElementById('beastSVG').innerHTML=beastSVG(summary.top);
  document.getElementById('mainBeastTitle').textContent = summary.dual ? `é›™ç¸å‹ï¼š${summary.top} Ã— ${summary.dual[1]}` : `ä¸»ç¥ç¸ï¼š${summary.top}`;
  document.getElementById('dualHint').textContent = summary.dual ? `ç¬¬äºŒä¸»å°èƒ½é‡ï¼š${summary.dual[1]}ï¼ˆå¯ä½œè¼”ä¿®ç·šï¼‰` : '';
  document.getElementById('mainBeastSummary').textContent = info.summary;

  const col=(title,items)=>`<div class="p-3 border rounded"><div class="font-semibold mb-1">${title}</div><ul class="list-disc pl-5 space-y-1">${items.map(x=>`<li>${x}</li>`).join('')}</ul></div>`;
  document.getElementById('adviceCols').innerHTML = col('è·å ´å»ºè­°',info.workplace)+col('æ„Ÿæƒ…å»ºè­°',info.love)+col('é¤Šç”Ÿå»ºè­°',info.health);

  const list=document.getElementById('scoreList'); list.innerHTML='';
  summary.ranking.forEach(([k,v])=> list.innerHTML += `<div class="flex items-center justify-between"><span>${k}</span><b>${v}</b></div>`);
}

/* ---------------- å•å·æäº¤ ---------------- */
document.getElementById('form').addEventListener('submit', (e)=>{
  e.preventDefault();
  const scores=calcScores();
  const summary=summarize(scores);
  drawRadar(scores);
  renderReport(summary, scores);
  localStorage.setItem('shen-v7', JSON.stringify({scores, summary, inst:getInst()}));
});

/* ---------------- é¡¯ç¤º/éš±è—å•å· ---------------- */
document.getElementById('btnToggleQ').onclick=()=>document.getElementById('questionWrap').classList.toggle('hidden');

/* ---------------- ä¸‹è¼‰ PNG & åˆ—å° ---------------- */
document.getElementById('btnPNG').onclick=()=>html2canvas(document.getElementById('resultCard'),{backgroundColor:'#ffffff',scale:2}).then(c=>{
  const a=document.createElement('a'); a.download='ç¥ç¸äººæ ¼_åˆ†æå ±è¡¨.png'; a.href=c.toDataURL('image/png'); a.click();
});
document.getElementById('btnPrint').onclick=()=>window.print();

/* ---------------- åˆ†æå¸«è¨­å®šï¼šè¼‰å…¥/å„²å­˜/å¥—ç”¨ ---------------- */
const elName=document.getElementById('fName'), elContact=document.getElementById('fContact'), elBio=document.getElementById('fBio'), elQR=document.getElementById('fQR');
function getInst(){ return { name:elName.value.trim(), contact:elContact.value.trim(), bio:elBio.value.trim(), qr:document.getElementById('vQR').src||'' }; }
function applyInst(inst){
  document.getElementById('vName').textContent = inst?.name || '';
  document.getElementById('vContact').textContent = inst?.contact || '';
  document.getElementById('vBio').textContent = inst?.bio || '';
  if(inst?.qr) document.getElementById('vQR').src = inst.qr;
  elName.value = inst?.name || elName.value;
  elContact.value = inst?.contact || elContact.value;
  elBio.value = inst?.bio || elBio.value;
}
elQR.addEventListener('change', e=>{
  const f=e.target.files?.[0]; if(!f) return;
  const r=new FileReader(); r.onload=()=>{ document.getElementById('vQR').src=r.result; saveAll(); }; r.readAsDataURL(f);
});

/* ---------------- èƒŒæ™¯æ¨£å¼ & ç‰¹æ•ˆ ---------------- */
const bodyRoot=document.getElementById('bodyRoot');
const bgStyle=document.getElementById('bgStyle'), c1=document.getElementById('c1'), c2=document.getElementById('c2'), customWrap=document.getElementById('customColors');
const bgImg=document.getElementById('bgImg'), bgOpacity=document.getElementById('bgOpacity'), fxTypeSel=document.getElementById('fxType');
let bgImgData=null, fxType=parseInt(fxTypeSel.value);

const STYLES={ A:['#B6822B','#FFFFFF'], B:['#1e3a8a','#4c1d95'], C:['#f97316','#b91c1c'], D:['#0f172a','#334155'], E:['#f8fafc','#e2e8f0'] };

function applyBG(){
  const s = localStorage.getItem('bgStyle') || bgStyle.value;
  const colorA = (s==='F' ? (localStorage.getItem('c1')||c1.value) : STYLES[s][0]);
  const colorB = (s==='F' ? (localStorage.getItem('c2')||c2.value) : STYLES[s][1]);
  bodyRoot.style.background = `linear-gradient(135deg, ${colorA}, ${colorB})`;
  const op = parseFloat(localStorage.getItem('bgOpacity') || bgOpacity.value);
  if(bgImgData){ bodyRoot.style.backgroundImage=`url(${bgImgData})`; bodyRoot.style.backgroundSize='cover'; bodyRoot.style.backgroundAttachment='fixed'; }
  bodyRoot.style.opacity = op;
}
bgStyle.onchange=()=>{ localStorage.setItem('bgStyle', bgStyle.value); customWrap.classList.toggle('hidden', bgStyle.value!=='F'); applyBG(); };
c1.oninput=()=>{ localStorage.setItem('c1', c1.value); applyBG(); };
c2.oninput=()=>{ localStorage.setItem('c2', c2.value); applyBG(); };
bgImg.onchange=e=>{ const f=e.target.files?.[0]; if(!f) return; const r=new FileReader(); r.onload=()=>{ bgImgData=r.result; applyBG(); saveAll(); }; r.readAsDataURL(f); };
bgOpacity.oninput=()=>{ localStorage.setItem('bgOpacity', bgOpacity.value); applyBG(); };
fxTypeSel.onchange=()=>{ fxType=parseInt(fxTypeSel.value,10); localStorage.setItem('fxType', fxType); };

/* ---------------- èƒŒæ™¯ Canvas ç‰¹æ•ˆ ---------------- */
const cvs=document.getElementById('bgfx'); const ctx=cvs.getContext('2d');
let W,H,particles=[];
function resize(){W=cvs.width=innerWidth;H=cvs.height=innerHeight;}
window.addEventListener('resize', resize); resize();
function initParticles(n=80){
  particles = Array.from({length:n}).map(()=>({
    x:Math.random()*W, y:Math.random()*H, r:Math.random()*2+1,
    vx:(Math.random()-0.5)*0.5, vy:(Math.random()-0.5)*0.5, a:Math.random()*0.5+0.2
  }));
}
initParticles();
function drawFX(){
  ctx.clearRect(0,0,W,H);
  if(fxType===0) return;
  if(fxType===1){ // æŸ”å’Œå…‰æšˆ
    for(let i=0;i<20;i++){
      ctx.beginPath();
      ctx.arc(Math.random()*W,Math.random()*H,Math.random()*60+20,0,2*Math.PI);
      ctx.fillStyle='rgba(255,255,255,0.08)';
      ctx.fill();
    }
  }else if(fxType===2){ // é“æ°£æµè½‰
    particles.forEach(p=>{
      p.x+=p.vx; p.y+=p.vy;
      if(p.x<0)p.x=W; if(p.x>W)p.x=0; if(p.y<0)p.y=H; if(p.y>H)p.y=0;
      ctx.beginPath(); ctx.arc(p.x,p.y,p.r,0,2*Math.PI);
      ctx.fillStyle=`rgba(255,255,255,${p.a})`; ctx.fill();
    });
  }else if(fxType===3){ // æ˜Ÿç©ºé–ƒçˆ
    ctx.fillStyle='rgba(255,255,255,0.85)';
    for(let i=0;i<60;i++){ if(Math.random()<0.06) ctx.fillRect(Math.random()*W,Math.random()*H,1.4,1.4); }
  }
  requestAnimationFrame(drawFX);
}
requestAnimationFrame(drawFX);

/* ---------------- å­˜å–è¨­å®š ---------------- */
function saveAll(){
  const inst=getInst();
  localStorage.setItem('inst', JSON.stringify(inst));
  localStorage.setItem('bgStyle', bgStyle.value);
  localStorage.setItem('bgOpacity', bgOpacity.value);
  localStorage.setItem('fxType', fxTypeSel.value);
  if(bgStyle.value==='F'){ localStorage.setItem('c1', c1.value); localStorage.setItem('c2', c2.value); }
}
document.getElementById('btnSave').onclick=()=>{ saveAll(); document.getElementById('panel').classList.remove('open'); };

/* ---------------- åˆå§‹è¼‰å…¥ ---------------- */
(function initLoad(){
  // é½’è¼ªé¢æ¿
  document.getElementById('gear').onclick=()=>document.getElementById('panel').classList.toggle('open');

  // è¨­å®šè¼‰å…¥
  const savedInst = JSON.parse(localStorage.getItem('inst')||'null');
  if(savedInst) applyInst(savedInst);

  const saved = JSON.parse(localStorage.getItem('shen-v7')||'null');
  if(saved){
    drawRadar(saved.scores);
    renderReport(saved.summary, saved.scores);
  }

  // èƒŒæ™¯è¼‰å…¥
  if(localStorage.getItem('bgStyle')) bgStyle.value = localStorage.getItem('bgStyle');
  if(localStorage.getItem('bgOpacity')) bgOpacity.value = localStorage.getItem('bgOpacity');
  if(bgStyle.value==='F'){ customWrap.classList.remove('hidden'); if(localStorage.getItem('c1')) c1.value=localStorage.getItem('c1'); if(localStorage.getItem('c2')) c2.value=localStorage.getItem('c2'); }
  if(localStorage.getItem('fxType')){ fxType = parseInt(localStorage.getItem('fxType'),10); fxTypeSel.value = fxType; }
  applyBG();

  // å•å·é è¨­å…ˆé¡¯ç¤º
})();

</script>
</body>
</html>
