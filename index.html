<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¥ç¸ä¸ƒåäºŒå‹äººæ ¼ æ¸¬é©—ï¼‹AIæ™ºèƒ½åˆ†æ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --primary: #b6822b;
            --secondary: #d4a017;
            --accent: #2b6cb0;
        }
        
        .brand { color: var(--primary); }
        .card { 
            background: #fff; 
            border: 1px solid #e5e7eb; 
            border-radius: 16px; 
            box-shadow: 0 4px 15px rgba(0,0,0,0.05); 
        }
        
        .option-card {
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            padding: 15px 10px;
            margin: 8px 0;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            font-weight: 500;
            font-size: 14px;
            position: relative;
        }
        
        .option-card:hover {
            background-color: #f8f9fa;
            border-color: #b6822b;
            transform: translateY(-2px);
        }
        
        .option-card.selected {
            background-color: #e7f3ff;
            border-color: #2b6cb0;
            transform: scale(1.02);
        }
        
        .option-card::before {
            content: '';
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 2px solid #ccc;
            border-radius: 50%;
            margin-right: 8px;
            vertical-align: middle;
            transition: all 0.3s ease;
        }
        
        .option-card.selected::before {
            background-color: #2b6cb0;
            border-color: #2b6cb0;
            transform: scale(1.2);
        }
        
        .option-card.selected::after {
            content: 'âœ“';
            position: absolute;
            color: white;
            font-size: 12px;
            left: 18px;
            top: 50%;
            transform: translateY(-50%);
        }
        
        .question-page {
            display: none;
        }
        
        .question-page.active {
            display: block;
        }
        
        .page-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 15px 0;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 8px;
        }
        
        .page-controls-bottom {
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 20px 0 10px 0;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            position: sticky;
            bottom: 10px;
            z-index: 10;
        }
        
        .superhero-card { 
            border-radius: 12px; 
            padding: 8px; 
            margin: 6px 0; 
            background: linear-gradient(135deg, #e8f4fd, #f0f9ff); 
            border: 2px solid var(--accent); 
        }
        
        .superhero-title { font-size: 1.2em; font-weight: bold; color: var(--accent); margin-bottom: 4px; }
        .superhero-ability { background: rgba(43, 108, 176, 0.1); padding: 4px; border-radius: 6px; margin: 4px 0; font-weight: bold; color: #2c5282; font-size: 1.0em; }
        .superhero-desc { font-size: 1.0em; color: #666; line-height: 1.3; }
        
        .superhero-image-container {
            width: 150px;
            height: 150px;
            margin: 0 auto 10px;
            border-radius: 12px;
            overflow: hidden;
            border: 3px solid var(--accent);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        
        .superhero-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.3s ease;
        }
        
        .superhero-image:hover {
            transform: scale(1.05);
        }
        
        .beast-simple {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5em;
            font-weight: bold;
            color: #b6822b;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
            padding: 10px;
            text-align: center;
            background: linear-gradient(135deg, rgba(182,130,43,0.1) 0%, rgba(182,130,43,0.05) 100%);
            border: 3px solid #b6822b;
            border-radius: 12px;
        }
        
        .ai-analysis-section { background: linear-gradient(135deg, #f8f9fa, #ffffff); border: 1px solid #e9ecef; border-radius: 12px; padding: 12px; margin: 8px 0; }
        .ai-analysis-header { display: flex; align-items: center; margin-bottom: 8px; padding-bottom: 6px; border-bottom: 2px solid #e9ecef; }
        .ai-analysis-icon { font-size: 1.5em; margin-right: 8px; }
        .ai-analysis-title { color: #2d3748; font-weight: bold; font-size: 1.2em; }
        .ai-analysis-content { font-size: 1.0em; color: #4a5568; line-height: 1.5; }
        .ai-analysis-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 8px; margin-top: 12px; }
        .ai-analysis-item { background: white; padding: 8px; border-radius: 6px; border-left: 4px solid var(--primary); box-shadow: 0 2px 4px rgba(0,0,0,0.05); }
        .ai-analysis-item-title { font-weight: bold; color: #2d3748; margin-bottom: 4px; font-size: 1.0em; }
        .ai-analysis-item-content { font-size: 0.95em; color: #718096; line-height: 1.4; }
        
        .ai-loading { text-align: center; padding: 20px; color: #718096; background: linear-gradient(135deg, #f8f9fa, #ffffff); border-radius: 12px; border: 2px dashed #e5e7eb; }
        
        .progress-container { width: 100%; background-color: #e5e7eb; border-radius: 10px; margin: 10px 0; overflow: hidden; }
        .progress-bar { height: 8px; background: linear-gradient(90deg, var(--primary), var(--secondary)); border-radius: 10px; transition: width 0.4s ease; width: 0%; }
        
        .slide-toggle {
            transition: all 0.3s ease-in-out;
            overflow: hidden;
            max-height: 1000px;
        }
        
        .slide-toggle.hidden {
            max-height: 0;
            padding-top: 0;
            padding-bottom: 0;
            margin-top: 0;
            margin-bottom: 0;
            opacity: 0;
        }
        
        .spinner { animation: spin 1.5s linear infinite; display: inline-block; font-size: 2em; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        
        .loading-dots:after { content: '.'; animation: dots 1.5s steps(5, end) infinite; }
        @keyframes dots { 0%, 20% { content: '.'; } 40% { content: '..'; } 60%, 100% { content: '...'; } }
        
        .print-header {
            display: none;
            margin-bottom: 20px;
            border-bottom: 3px solid #b6822b;
            padding-bottom: 15px;
            page-break-before: always;
        }
        
        @media print {
            .no-print { display: none !important; }
            .print-header { 
                display: block !important; 
            }
            body { 
                background: white !important; 
                font-size: 14px !important; 
                color: black !important; 
            }
            .card {
                box-shadow: none;
                border: 1px solid #ddd;
            }
        }
        
        @media screen {
            #radar { width: 100% !important; height: 300px !important; }
        }
    </style>
</head>
<body class="text-slate-800 bg-gradient-to-br from-amber-50 to-amber-100">
    <main class="max-w-5xl mx-auto p-4 sm:p-6">
        <!-- é é¦– -->
        <header class="mb-4 flex justify-between items-center no-print">
            <div class="flex items-center gap-3">
                <div class="h-10 w-10 rounded bg-amber-500 flex items-center justify-center text-white font-bold">ä»™</div>
                <div>
                    <h1 class="text-2xl sm:text-3xl font-extrabold brand">ç¥ç¸ä¸ƒåäºŒå‹äººæ ¼ æ¸¬é©—ï¼‹AIæ™ºèƒ½åˆ†æ</h1>
                    <p class="text-sm text-slate-600">å…­ç¸é›·é”åœ–ãƒ»ä¸»å‹è§£æãƒ»ä¸‰æ¬„å»ºè­°ãƒ»AIåˆ†æå ±å‘Š</p>
                </div>
            </div>
            <button id="toggleSettingsBtn" type="button" class="no-print p-2 rounded-full hover:bg-amber-100 transition">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-slate-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" />
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                </svg>
            </button>
        </header>

        <!-- è¨­å®šè¡¨å–® -->
        <form id="reportSettingsForm" class="card p-4 mb-4 no-print slide-toggle hidden">
            <h2 class="font-bold mb-3">âš™ï¸ å ±è¡¨è³‡è¨Šè¨­å®š</h2>
            <div class="space-y-4 text-sm">
                <div class="grid grid-cols-2 gap-3">
                    <div>
                        <label class="block text-sm mb-1">é¡Œç›®é¡¯ç¤ºï¼š</label>
                        <select id="pageMode" class="w-full p-2 border rounded">
                            <option value="single">å–®é¡Œæ¨¡å¼</option>
                            <option value="multi10" selected>10é¡Œæ¨¡å¼</option>
                            <option value="all">å…¨éƒ¨é¡¯ç¤º</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm mb-1">å ±è¡¨å­—é«”å¤§å°ï¼š</label>
                        <select id="reportFontSize" class="w-full p-2 border rounded">
                            <option value="small">å°</option>
                            <option value="medium" selected>ä¸­</option>
                            <option value="large">å¤§</option>
                            <option value="xlarge">ç‰¹å¤§</option>
                        </select>
                    </div>
                </div>
            </div>
            <div class="mt-4">
                <button type="submit" class="bg-blue-600 text-white px-5 py-2 rounded hover:bg-blue-700 transition text-sm">å„²å­˜è¨­å®š</button>
            </div>
        </form>

        <!-- æ¸¬é©—è¡¨å–® -->
        <form id="form" class="card p-4 mb-4 no-print">
            <h2 class="font-bold mb-3">ğŸ“‹ è«‹å›ç­”ä¸‹åˆ—30é¡Œï¼ˆ1ï¼ä¸åŒæ„ï¼Œ5ï¼éå¸¸åŒæ„ï¼‰</h2>
            
            <!-- åˆ†é æ§åˆ¶ - ä¸Šæ–¹ -->
            <div class="page-controls no-print">
                <div class="font-controls">
                    <label for="pageModeSelect" class="text-sm font-medium">é¡¯ç¤ºæ¨¡å¼ï¼š</label>
                    <select id="pageModeSelect" class="text-sm border rounded p-1">
                        <option value="single">å–®é¡Œæ¨¡å¼</option>
                        <option value="multi10" selected>10é¡Œæ¨¡å¼</option>
                        <option value="all">å…¨éƒ¨é¡¯ç¤º</option>
                    </select>
                </div>
                <div class="pagination-buttons flex gap-2">
                    <button type="button" id="prevPage" class="px-3 py-1 border rounded text-sm hover:bg-gray-50 transition" disabled>ä¸Šä¸€é </button>
                    <span id="pageIndicator" class="px-3 py-1 text-sm">1/3</span>
                    <button type="button" id="nextPage" class="px-3 py-1 border rounded text-sm hover:bg-gray-50 transition">ä¸‹ä¸€é </button>
                </div>
            </div>
            
            <div class="mb-4 p-3 bg-slate-50 rounded-lg">
                <label class="font-semibold text-slate-700 block mb-2">è«‹é¸æ“‡æ‚¨çš„æ€§åˆ¥ï¼š</label>
                <div class="flex gap-4">
                    <label class="flex items-center">
                        <input type="radio" name="gender" value="male" class="mr-2" checked>
                        ç”·æ€§
                    </label>
                    <label class="flex items-center">
                        <input type="radio" name="gender" value="female" class="mr-2">
                        å¥³æ€§
                    </label>
                    <label class="flex items-center">
                        <input type="radio" name="gender" value="other" class="mr-2">
                        å…¶ä»–
                    </label>
                </div>
            </div>
            
            <!-- åˆ†é å®¹å™¨ -->
            <div id="questionPages" class="space-y-3">
                <!-- é¡Œç›®å°‡é€šéJavaScriptå‹•æ…‹ç”Ÿæˆ -->
            </div>
            
            <!-- åˆ†é æ§åˆ¶ - ä¸‹æ–¹ -->
            <div class="page-controls-bottom no-print">
                <div class="pagination-buttons flex gap-2">
                    <button type="button" id="prevPageBottom" class="px-4 py-2 border rounded hover:bg-gray-50 transition" disabled>ä¸Šä¸€é </button>
                    <span id="pageIndicatorBottom" class="px-4 py-2 text-sm font-medium">ç¬¬ 1 é ï¼Œå…± 3 é </span>
                    <button type="button" id="nextPageBottom" class="px-4 py-2 border rounded hover:bg-gray-50 transition">ä¸‹ä¸€é </button>
                </div>
            </div>
            
            <!-- é€²åº¦é¡¯ç¤º -->
            <div id="progress" class="text-right text-sm mt-4">0/30</div>
            
            <div class="mt-4 flex gap-3">
                <button type="submit" class="bg-amber-600 text-white px-5 py-2 rounded hover:bg-amber-700 transition">é€å‡ºæ¸¬é©—</button>
                <button type="button" id="btnFillMid" class="border px-3 py-2 rounded hover:bg-gray-50 transition">å…¨éƒ¨å¡«3</button>
            </div>
        </form>

        <!-- å ±è¡¨å­—é«”å¤§å°æ§åˆ¶ -->
        <div class="report-font-controls no-print">
            <span class="text-sm font-medium">å ±è¡¨å­—é«”å¤§å°ï¼š</span>
            <select id="reportFontSizeSelect" class="text-sm border rounded p-1">
                <option value="small">å°</option>
                <option value="medium" selected>ä¸­</option>
                <option value="large">å¤§</option>
                <option value="xlarge">ç‰¹å¤§</option>
            </select>
            <button type="button" id="applyFontSize" class="px-3 py-1 bg-blue-600 text-white rounded text-sm hover:bg-blue-700 transition">å¥—ç”¨</button>
        </div>

        <!-- åˆ—å°æ¨™é ­ -->
        <div class="print-header">
            <div class="header-title-container">
                <h1 class="report-main-title">ä»™äººæŒ‡è·¯ç¥ç¸ä¸ƒåäºŒå‹äººæ ¼</h1>
                <p class="report-subtitle">å€‹äººåŒ–æ·±åº¦åˆ†æå ±å‘Š</p>
                <div class="print-date">å ±å‘Šç”Ÿæˆæ™‚é–“ï¼š<span id="report-date"></span></div>
            </div>
        </div>

        <!-- æ¸¬é©—çµæœ -->
        <section id="result" class="grid lg:grid-cols-2 gap-4 print-section" style="display: none;">
            <div class="card p-4">
                <h2 class="font-bold mb-2">å…­ç¸èƒ½é‡é›·é”åœ–</h2>
                <div id="radar-container"><canvas id="radar"></canvas></div>
                <button class="mt-3 px-4 py-2 border rounded no-print hover:bg-gray-50 transition" onclick="printAnalysis()">ğŸ–¨ï¸ åˆ—å°åˆ†æå ±å‘Š</button>
            </div>
            <div class="card p-4" id="resultCard">
                <h2 class="font-bold mb-2">ä¸»å‹èˆ‡ä¸‰æ¬„å»ºè­°</h2>
                <div class="grid grid-cols-3 gap-3 items-start">
                    <!-- ç¥ç¸é¡¯ç¤º -->
                    <div id="beastSVG" class="w-full aspect-square">
                        <div class="beast-simple" id="beastSimple">
                            <!-- ç¥ç¸åç¨±å°‡é€šéJavaScriptå‹•æ…‹ç”Ÿæˆ -->
                        </div>
                    </div>
                    <div class="col-span-2">
                        <div id="mainBeastTitle" class="font-bold brand text-lg"></div>
                        <div id="dualHint" class="text-sm text-slate-600 mt-1"></div>
                        <div id="mainBeastSummary" class="mt-2 text-sm"></div>
                    </div>
                </div>
                <hr class="my-2" />
                <div id="adviceCols" class="grid md:grid-cols-3 gap-2 text-sm"></div>
                <div class="mt-3 flex gap-2 no-print">
                    <button id="btnShare" class="px-4 py-2 border rounded hover:bg-gray-50 transition">åˆ†äº«çµæœåœ–ç‰‡</button>
                    <button class="px-4 py-2 border rounded hover:bg-gray-50 transition" onclick="printAnalysis()">ğŸ–¨ï¸ åˆ—å°åˆ†æå ±å‘Š</button>
                </div>
            </div>
        </section>

        <!-- è¶…äººå ±å‘Š -->
        <section class="card p-4 mt-4 print-section" id="superheroReport" style="display: none;">
            <h2 class="font-bold mb-2">ğŸ¦¸â€â™‚ï¸ ä½ çš„ç¥ç¸è¶…äººèº«åˆ†</h2>
            <div id="superhero-display" class="superhero-card">
                <div class="superhero-image-container">
                    <div class="beast-simple" id="superhero-beast">
                        <!-- ç¥ç¸åç¨±å°‡é€šéJavaScriptå‹•æ…‹ç”Ÿæˆ -->
                    </div>
                </div>
                <div id="superhero-name" class="superhero-title"></div>
                <div id="superhero-ability" class="superhero-ability"></div>
                <div id="superhero-mission" class="superhero-desc"></div>
                <div id="superhero-local" class="text-sm mt-2 font-bold text-blue-700"></div>
            </div>
        </section>

        <!-- AIå ±å‘Š -->
        <section class="card p-4 mt-4 print-section" id="aiReport" style="display: none;">
            <h2 class="font-bold mb-2">ğŸ¤– AI æ™ºèƒ½å€‹äººåŒ–åˆ†æå ±å‘Š</h2>
            <p class="text-sm text-slate-600 mb-2">ä»¥ä¸‹å…§å®¹ç”±ä»™äººæŒ‡è·¯AIç³»çµ±ç”Ÿæˆï¼Œèåˆé‡‘éŒ¢å¦ã€äº”è¡Œã€åœ°æ”¯èˆ‡å¿ƒç†è¦–è§’ã€‚</p>
            <div id="ai-analysis-structured">
                <div class="ai-loading" id="ai-loading" style="display: none;">
                    <div class="spinner">ğŸ”®</div>
                    <p class="mt-2 text-lg font-semibold">AI æ­£åœ¨ç‚ºæ‚¨æ·±åº¦åˆ†æä¸­<span class="loading-dots"></span></p>
                    <p class="mt-1 text-sm text-gray-600">é€™å¯èƒ½éœ€è¦ 10-20 ç§’ï¼Œè«‹ç¨å€™</p>
                    <div class="progress-container mt-3"><div class="progress-bar" id="progress-bar"></div></div>
                    <div class="mt-2 text-xs text-gray-500" id="loading-step">åˆå§‹åŒ–åˆ†æå¼•æ“...</div>
                </div>
                <div id="ai-analysis-content">
                    <div class="ai-analysis-section">
                        <div class="ai-analysis-header"><div class="ai-analysis-icon">ğŸ­</div><div class="ai-analysis-title">äººæ ¼ç‰¹è³ªåˆ†æ</div></div>
                        <div class="ai-analysis-content" id="ai-personality"><div class="text-gray-500 text-center py-3">é»æ“Šã€Œç”Ÿæˆæ·±åº¦åˆ†æã€ç²å–è©³ç´°è§£æ</div></div>
                    </div>
                    <div class="ai-analysis-section">
                        <div class="ai-analysis-header"><div class="ai-analysis-icon">âš¡</div><div class="ai-analysis-title">èƒ½é‡å„ªå‹¢åˆ†æ</div></div>
                        <div class="ai-analysis-content" id="ai-strengths"><div class="text-gray-500 text-center py-3">é»æ“Šã€Œç”Ÿæˆæ·±åº¦åˆ†æã€ç²å–è©³ç´°è§£æ</div></div>
                    </div>
                    <div class="ai-analysis-section">
                        <div class="ai-analysis-header"><div class="ai-analysis-icon">ğŸ“ˆ</div><div class="ai-analysis-title">æˆé•·ç™¼å±•å»ºè­°</div></div>
                        <div class="ai-analysis-grid">
                            <div class="ai-analysis-item"><div class="ai-analysis-item-title">è·å ´ç™¼å±•</div><div class="ai-analysis-item-content" id="ai-career">é»æ“Šã€Œç”Ÿæˆæ·±åº¦åˆ†æã€ç²å–è·å ´å»ºè­°</div></div>
                            <div class="ai-analysis-item"><div class="ai-analysis-item-title">äººéš›é—œä¿‚</div><div class="ai-analysis-item-content" id="ai-relationships">é»æ“Šã€Œç”Ÿæˆæ·±åº¦åˆ†æã€ç²å–äººéš›å»ºè­°</div></div>
                            <div class="ai-analysis-item"><div class="ai-analysis-item-title">å€‹äººæˆé•·</div><div class="ai-analysis-item-content" id="ai-growth">é»æ“Šã€Œç”Ÿæˆæ·±åº¦åˆ†æã€ç²å–æˆé•·å»ºè­°</div></div>
                        </div>
                    </div>
                    <div class="ai-analysis-section">
                        <div class="ai-analysis-header"><div class="ai-analysis-icon">ğŸ’°</div><div class="ai-analysis-title">äº”è¡Œé‡‘éŒ¢å¦è§£æ</div></div>
                        <div class="ai-analysis-content" id="ai-money"><div class="text-gray-500 text-center py-3">é»æ“Šã€Œç”Ÿæˆæ·±åº¦åˆ†æã€ç²å–é‡‘éŒ¢å¦è§£æ</div></div>
                    </div>
                </div>
            </div>
            <div class="flex gap-2 no-print mt-3">
                <button id="btnAI" class="px-4 py-2 border rounded bg-amber-500 text-white hover:bg-amber-600 transition">ç”Ÿæˆæ·±åº¦åˆ†æ</button>
                <button id="btnRetry" class="px-4 py-2 border rounded bg-gray-200 hover:bg-gray-300 transition" style="display:none;">é‡æ–°åˆ†æ</button>
                <button class="px-4 py-2 border rounded hover:bg-gray-50 transition" onclick="printAnalysis()">ğŸ–¨ï¸ åˆ—å°å®Œæ•´å ±å‘Š</button>
            </div>
        </section>

        <footer class="text-center text-xs text-slate-500 mt-6 no-print">
            <div class="flex justify-center items-center gap-4 mb-1">
                <span>Â© 2025 ä»™äººæŒ‡è·¯å åœç ”ç©¶å­¸æœƒ</span><span>|</span><span>æ¸¬é©—åƒ…ä¾›è¦ºå¯Ÿèˆ‡æ•™å­¸ç”¨é€”</span>
            </div>
        </footer>
    </main>

    <script>
        // ========== åˆå§‹åŒ–è¨­å®š ==========
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
        });

        // ========== æ¸¬é©—é¡Œåº« ==========
        const BANK = [
            {t: "æˆ‘å¸¸æœ‰çªå¦‚å…¶ä¾†çš„éˆæ„Ÿä¸¦æƒ³ç«‹å³å˜—è©¦ã€‚", b: "é’é¾"},
            {t: "æˆ‘å–œæ­¡æ‰“ç ´å¸¸è¦å°‹æ‰¾æ–°æ–¹æ³•ã€‚", b: "é’é¾"},
            {t: "é‡é˜»åŠ›æ™‚æˆ‘æœƒéˆæ´»è½‰å‘ã€‚", b: "é’é¾"},
            {t: "æˆ‘å¯Œæƒ³åƒåŠ›ï¼Œå–œæ­¡å‰µæ–°æ€è€ƒã€‚", b: "é’é¾"},
            {t: "æˆ‘ç†±æ„›æ¢ç´¢æœªçŸ¥äº‹ç‰©ã€‚", b: "é’é¾"},
            {t: "æˆ‘å–œæ­¡åœ¨äººç¾¤ä¸­è¡¨é”è‡ªå·±ã€‚", b: "æœ±é›€"},
            {t: "æˆ‘ç”¨æƒ…ç·’å¸¶å‹•ä»–äººã€‚", b: "æœ±é›€"},
            {t: "åˆ¥äººçš„åæ‡‰æœƒå½±éŸ¿æˆ‘ã€‚", b: "æœ±é›€"},
            {t: "æˆ‘æ“…é•·èªªæœèˆ‡æ¼”èªªã€‚", b: "æœ±é›€"},
            {t: "æˆ‘é‡è¦–è¢«å‚¾è½èˆ‡é—œæ³¨ã€‚", b: "æœ±é›€"},
            {t: "æˆ‘å–œæ­¡æŒ‰è¨ˆç•«è¡Œäº‹ã€‚", b: "å‹¾é™³"},
            {t: "æˆ‘é‡è¦–å®‰å…¨æ„Ÿèˆ‡ç©©å®šã€‚", b: "å‹¾é™³"},
            {t: "æˆ‘è²¬ä»»æ„Ÿå¼·ã€‚", b: "å‹¾é™³"},
            {t: "æˆ‘å‚¾å‘ç¶­æŒç¾ç‹€ã€‚", b: "å‹¾é™³"},
            {t: "æˆ‘æ³¨é‡ç´°ç¯€èˆ‡ç¨‹åºã€‚", b: "å‹¾é™³"},
            {t: "æˆ‘å°ä»–äººæƒ…ç·’å¾ˆæ•æ„Ÿã€‚", b: "è£è›‡"},
            {t: "æˆ‘æ“…é•·è§€å¯Ÿèˆ‡å‚¾è½ã€‚", b: "è£è›‡"},
            {t: "æˆ‘å¸¸æ€è€ƒèƒŒå¾Œçš„å‹•æ©Ÿã€‚", b: "è£è›‡"},
            {t: "æˆ‘æ€è€ƒäº‹æƒ…æœƒè€ƒé‡æ™‚æ©Ÿèˆ‡äººå¿ƒã€‚", b: "è£è›‡"},
            {t: "æˆ‘å–„æ–¼å”èª¿ä¸åŒè§€é»ã€‚", b: "è£è›‡"},
            {t: "æˆ‘è¬›æ±‚æ•ˆç‡èˆ‡çµæœã€‚", b: "ç™½è™"},
            {t: "æˆ‘æœƒä¸»å‹•åšæ±ºç­–ã€‚", b: "ç™½è™"},
            {t: "æˆ‘ä»¥æ•¸æ“šèˆ‡æˆæœç‚ºå°å‘ã€‚", b: "ç™½è™"},
            {t: "æˆ‘é¡˜æ„æ‰¿æ“”å£“åŠ›ä»¥å®Œæˆä»»å‹™ã€‚", b: "ç™½è™"},
            {t: "æˆ‘åå¥½æ˜ç¢ºçš„è¦ç¯„èˆ‡æ¨™æº–ã€‚", b: "ç™½è™"},
            {t: "æˆ‘å–œæ­¡ç¨è‡ªæ€è€ƒã€‚", b: "ç„æ­¦"},
            {t: "æˆ‘å‚¾å‘è¬¹æ…è©•ä¼°å¾Œè¡Œå‹•ã€‚", b: "ç„æ­¦"},
            {t: "æˆ‘æ“…é•·è¦åŠƒé•·é ç›®æ¨™ã€‚", b: "ç„æ­¦"},
            {t: "æˆ‘é‡è¦–é‚è¼¯èˆ‡åˆ†æã€‚", b: "ç„æ­¦"},
            {t: "æˆ‘ç¿’æ…£å†·éœçœ‹å¾…å•é¡Œã€‚", b: "ç„æ­¦"}
        ];

        // ========== è¶…äººé¡¯ç¤ºè³‡æ–™ ==========
        const superheroData = {
            'é’é¾': {
                male: { 
                    name:'å‰µæ„é£›é¾è¶…äºº', 
                    ability:'ğŸ¦¸â€â™‚ï¸ è¶…èƒ½åŠ›ï¼šéˆæ„Ÿçˆ†ç™¼ + å¿«é€Ÿæ‡‰è®Š + çªç ´æ¡†æ¶', 
                    mission:'ğŸ¯ å°ˆå±¬ä»»å‹™ï¼šå‰µæ–°å°ˆæ¡ˆç™¼èµ·äººã€å±æ©Ÿè™•ç†å°ˆå®¶ã€æ–°é ˜åŸŸé–‹æ‹“è€…', 
                    localName:'å°ç£é»å­ç‹', 
                    description:'ä½ å°±åƒå°ç£çš„å‰µæ–°å¼•æ“ï¼Œç¸½èƒ½æƒ³å‡ºè®“äººé©šè‰·çš„é»å­ï¼'
                },
                female: { 
                    name:'å‰µæ„é£›é¾å¥³ä¿ ', 
                    ability:'ğŸ¦¸â€â™€ï¸ è¶…èƒ½åŠ›ï¼šéˆæ„Ÿçˆ†ç™¼ + ç›´è¦ºæ´å¯Ÿ + è·¨ç•Œèåˆ', 
                    mission:'ğŸ¯ å°ˆå±¬ä»»å‹™ï¼šå‰µæ„ç­–åŠƒå¸«ã€åœ˜éšŠå”èª¿è€…ã€ç¾æ„Ÿå¼•å°è€…', 
                    localName:'å°ç£å‰µæ„å¥³ç¥', 
                    description:'ä½ æ˜¯å°ç£çš„å‰µæ„å¥³ç¥ï¼Œç¸½èƒ½å°‡éˆæ„Ÿè½‰åŒ–ç‚ºå‹•äººçš„ä½œå“ï¼'
                },
                other: { 
                    name:'å‰µæ„é£›é¾ä½¿è€…', 
                    ability:'ğŸ¦¸ è¶…èƒ½åŠ›ï¼šéˆæ„Ÿçˆ†ç™¼ + å¤šå…ƒè¦–è§’ + è·¨ç•Œé€£çµ', 
                    mission:'ğŸ¯ å°ˆå±¬ä»»å‹™ï¼šå‰µæ„æ©‹æ¨‘ã€å¤šå…ƒæ–‡åŒ–èåˆè€…ã€å‰µæ–°å‚¬åŒ–åŠ‘', 
                    localName:'å°ç£å‰µæ„å¤§ä½¿', 
                    description:'ä½ æ˜¯å°ç£çš„å‰µæ„å¤§ä½¿ï¼Œç”¨å¤šå…ƒè¦–è§’é€£çµä¸åŒé ˜åŸŸï¼'
                }
            },
            'æœ±é›€': {
                male: { 
                    name:'ç†±æƒ…é³³å‡°è¶…äºº', 
                    ability:'ğŸ¦¸â€â™‚ï¸ è¶…èƒ½åŠ›ï¼šæ„ŸæŸ“åŠ›å ´ + æºé€šå¤§å¸« + æ¿€å‹µå…‰ç’°', 
                    mission:'ğŸ¯ å°ˆå±¬ä»»å‹™ï¼šåœ˜éšŠå£«æ°£å……é›»ç«™ã€å…¬é—œæºé€šé”äººã€æ•™è‚²æ¨å»£å…ˆé‹’', 
                    localName:'å°ç£ç†±æƒ…å¤§ä½¿', 
                    description:'ä½ æ˜¯å°ç£çš„äººæ°£ç‹ï¼Œç”¨ç†±æƒ…æ„ŸæŸ“èº«é‚Šçš„æ¯ä¸€å€‹äººï¼'
                },
                female: { 
                    name:'ç†±æƒ…é³³å‡°å¥³ä¿ ', 
                    ability:'ğŸ¦¸â€â™€ï¸ è¶…èƒ½åŠ›ï¼šæƒ…æ„Ÿå…±é³´ + æºé€šè—è¡“ + æº«æš–ç™‚ç™’', 
                    mission:'ğŸ¯ å°ˆå±¬ä»»å‹™ï¼šæƒ…æ„Ÿæ”¯æŒè€…ã€åœ˜éšŠå‡èšè€…ã€å¿ƒéˆç™‚ç™’å¸«', 
                    localName:'å°ç£æš–å¿ƒå¤©ä½¿', 
                    description:'ä½ æ˜¯å°ç£çš„æš–å¿ƒå¤©ä½¿ï¼Œç”¨çœŸèª èˆ‡æº«æš–ç…§äº®ä»–äººï¼'
                },
                other: { 
                    name:'ç†±æƒ…é³³å‡°ä½¿è€…', 
                    ability:'ğŸ¦¸ è¶…èƒ½åŠ›ï¼šæƒ…æ„Ÿé€£çµ + å¤šå…ƒæºé€š + ç¤¾ç¾¤å‡èš', 
                    mission:'ğŸ¯ å°ˆå±¬ä»»å‹™ï¼šç¤¾ç¾¤æ©‹æ¨‘ã€æƒ…æ„Ÿæ”¯æŒè€…ã€å¤šå…ƒæ–‡åŒ–æ¨å»£è€…', 
                    localName:'å°ç£æƒ…æ„Ÿé€£çµè€…', 
                    description:'ä½ æ˜¯å°ç£çš„æƒ…æ„Ÿé€£çµè€…ï¼Œç”¨çœŸèª é€£çµä¸åŒçš„å¿ƒéˆï¼'
                }
            },
            'å‹¾é™³': {
                male: { 
                    name:'ç©©å›ºåŸç‰†è¶…äºº', 
                    ability:'ğŸ¦¸â€â™‚ï¸ è¶…èƒ½åŠ›ï¼šå¯é é˜²è­· + ç´°ç¯€æŒæ§ + åŸ·è¡ŒåŠ›å ´', 
                    mission:'ğŸ¯ å°ˆå±¬ä»»å‹™ï¼šç³»çµ±ç©©å®šå®ˆè­·è€…ã€å“è³ªæŠŠé—œå°ˆå®¶ã€é•·æœŸè¦åŠƒå¸«', 
                    localName:'å°ç£åœ°åŸºä¸»', 
                    description:'ä½ æ˜¯å°ç£çš„ç©©å®šåŠ›é‡ï¼Œåƒå …å›ºçš„åœ°åŸºä¸€æ¨£å¯é ï¼'
                },
                female: { 
                    name:'ç©©å›ºåŸç‰†å¥³ä¿ ', 
                    ability:'ğŸ¦¸â€â™€ï¸ è¶…èƒ½åŠ›ï¼šç´°å¿ƒå®ˆè­· + çµ„ç¹”å”èª¿ + ç©©å®šæ”¯æŒ', 
                    mission:'ğŸ¯ å°ˆå±¬ä»»å‹™ï¼šç³»çµ±ç¶­è­·è€…ã€å“è³ªå®ˆè­·è€…ã€åœ˜éšŠç©©å®šåŠ‘', 
                    localName:'å°ç£å®ˆè­·å¤©ä½¿', 
                    description:'ä½ æ˜¯å°ç£çš„å®ˆè­·å¤©ä½¿ï¼Œç”¨ç´°å¿ƒèˆ‡ç©©å®šæ”¯æŒè‘—æ¯å€‹äººï¼'
                },
                other: { 
                    name:'ç©©å›ºåŸç‰†ä½¿è€…', 
                    ability:'ğŸ¦¸ è¶…èƒ½åŠ›ï¼šç³»çµ±æ€ç¶­ + ç©©å®šå»ºæ§‹ + å¤šå…ƒå”èª¿', 
                    mission:'ğŸ¯ å°ˆå±¬ä»»å‹™ï¼šç³»çµ±æ¶æ§‹å¸«ã€ç©©å®šç¶­è­·è€…ã€å¤šå…ƒå”èª¿è€…', 
                    localName:'å°ç£ç³»çµ±å®ˆè­·è€…', 
                    description:'ä½ æ˜¯å°ç£çš„ç³»çµ±å®ˆè­·è€…ï¼Œç”¨ç©©å®šçš„åŠ›é‡å»ºæ§‹æ›´å¥½çš„ç’°å¢ƒï¼'
                }
            },
            'è£è›‡': {
                male: { 
                    name:'æ´å¯Ÿéˆè›‡è¶…äºº', 
                    ability:'ğŸ¦¸â€â™‚ï¸ è¶…èƒ½åŠ›ï¼šè®€å¿ƒæ„ŸçŸ¥ + å”èª¿åŠ›å ´ + æ™‚æ©ŸæŒæ§', 
                    mission:'ğŸ¯ å°ˆå±¬ä»»å‹™ï¼šäººéš›é—œä¿‚èª¿è§£å“¡ã€ç­–ç•¥åˆ†æå¸«ã€å±æ©Ÿé è­¦ç³»çµ±', 
                    localName:'å°ç£å’Œäº‹ä½¬', 
                    description:'ä½ æ˜¯å°ç£çš„äººéš›é›·é”ï¼Œç¸½èƒ½æ´å¯Ÿäººå¿ƒã€åŒ–è§£è¡çªï¼'
                },
                female: { 
                    name:'æ´å¯Ÿéˆè›‡å¥³ä¿ ', 
                    ability:'ğŸ¦¸â€â™€ï¸ è¶…èƒ½åŠ›ï¼šç›´è¦ºæ„ŸçŸ¥ + æƒ…æ„Ÿå”èª¿ + æ™‚æ©Ÿæ´å¯Ÿ', 
                    mission:'ğŸ¯ å°ˆå±¬ä»»å‹™ï¼šæƒ…æ„Ÿèª¿è§£å¸«ã€åœ˜éšŠæ½¤æ»‘åŠ‘ã€å±æ©Ÿé é˜²å°ˆå®¶', 
                    localName:'å°ç£å¿ƒéˆå°å¸«', 
                    description:'ä½ æ˜¯å°ç£çš„å¿ƒéˆå°å¸«ï¼Œç”¨ç›´è¦ºèˆ‡æ™ºæ…§å¼•å°ä»–äººï¼'
                },
                other: { 
                    name:'æ´å¯Ÿéˆè›‡ä½¿è€…', 
                    ability:'ğŸ¦¸ è¶…èƒ½åŠ›ï¼šå¤šå…ƒæ„ŸçŸ¥ + é—œä¿‚å”èª¿ + æ™‚æ©Ÿåˆ¤æ–·', 
                    mission:'ğŸ¯ å°ˆå±¬ä»»å‹™ï¼šé—œä¿‚æ©‹æ¨‘ã€å¤šå…ƒå”èª¿è€…ã€æ™‚æ©Ÿåˆ†æå¸«', 
                    localName:'å°ç£å”èª¿å°ˆå®¶', 
                    description:'ä½ æ˜¯å°ç£çš„å”èª¿å°ˆå®¶ï¼Œç”¨æ™ºæ…§é€£çµä¸åŒçš„äººéš›ç¶²çµ¡ï¼'
                }
            },
            'ç™½è™': {
                male: { 
                    name:'ç–¾é¢¨æˆ°ç¥è¶…äºº', 
                    ability:'ğŸ¦¸â€â™‚ï¸ è¶…èƒ½åŠ›ï¼šæ±ºæ–·åŠ›å ´ + è¡Œå‹•åŠ é€Ÿ + ç›®æ¨™é–å®š', 
                    mission:'ğŸ¯ å°ˆå±¬ä»»å‹™ï¼šç·Šæ€¥æ•‘æ´éšŠé•·ã€å°ˆæ¡ˆé ˜å°è€…ã€æ•ˆç‡å„ªåŒ–å¸«', 
                    localName:'å°ç£æ€¥å…ˆé‹’', 
                    description:'ä½ æ˜¯å°ç£çš„è¡Œå‹•æ´¾ï¼Œåƒç–¾é¢¨ä¸€æ¨£å¿«é€Ÿè§£æ±ºå•é¡Œï¼'
                },
                female: { 
                    name:'ç–¾é¢¨æˆ°ç¥å¥³ä¿ ', 
                    ability:'ğŸ¦¸â€â™€ï¸ è¶…èƒ½åŠ›ï¼šæœæ–·æ±ºç­– + é«˜æ•ˆåŸ·è¡Œ + ç›®æ¨™é”æˆ', 
                    mission:'ğŸ¯ å°ˆå±¬ä»»å‹™ï¼šå±æ©Ÿè™•ç†å°ˆå®¶ã€æ•ˆç‡é ˜å°è€…ã€ç›®æ¨™é”æˆå¸«', 
                    localName:'å°ç£è¡Œå‹•å¥³ç¥', 
                    description:'ä½ æ˜¯å°ç£çš„è¡Œå‹•å¥³ç¥ï¼Œç”¨æ•ˆç‡èˆ‡æ±ºæ–·åŠ›å®Œæˆä»»å‹™ï¼'
                },
                other: { 
                    name:'ç–¾é¢¨æˆ°ç¥ä½¿è€…', 
                    ability:'ğŸ¦¸ è¶…èƒ½åŠ›ï¼šå¤šå…ƒæ±ºç­– + é«˜æ•ˆå”èª¿ + ç›®æ¨™ç®¡ç†', 
                    mission:'ğŸ¯ å°ˆå±¬ä»»å‹™ï¼šæ•ˆç‡å”èª¿è€…ã€å¤šå…ƒé ˜å°è€…ã€ç›®æ¨™ç®¡ç†å¸«', 
                    localName:'å°ç£æ•ˆç‡å°ˆå®¶', 
                    description:'ä½ æ˜¯å°ç£çš„æ•ˆç‡å°ˆå®¶ï¼Œç”¨å¤šå…ƒè¦–è§’é”æˆç›®æ¨™ï¼'
                }
            },
            'ç„æ­¦': {
                male: { 
                    name:'æ™ºæ…§é¾œä»™è¶…äºº', 
                    ability:'ğŸ¦¸â€â™‚ï¸ è¶…èƒ½åŠ›ï¼šæ·±åº¦æ€è€ƒ + ç­–ç•¥è¦åŠƒ + å†·éœå±éšœ', 
                    mission:'ğŸ¯ å°ˆå±¬ä»»å‹™ï¼šé•·é è¦åŠƒå¸«ã€æŠ€è¡“ç ”ç™¼å°ˆå®¶ã€æ™ºæ…§æ±ºç­–é¡§å•', 
                    localName:'å°ç£è«¸è‘›äº®', 
                    description:'ä½ æ˜¯å°ç£çš„æ™ºæ…§å¯¶åº«ï¼Œåƒé¾œç”²ä¸€æ¨£ä¿è­·é‡è¦æ±ºç­–ï¼'
                },
                female: { 
                    name:'æ™ºæ…§é¾œä»™å¥³ä¿ ', 
                    ability:'ğŸ¦¸â€â™€ï¸ è¶…èƒ½åŠ›ï¼šæ·±åº¦åˆ†æ + ç­–ç•¥æ€è€ƒ + å†·éœæ™ºæ…§', 
                    mission:'ğŸ¯ å°ˆå±¬ä»»å‹™ï¼šç­–ç•¥è¦åŠƒå¸«ã€æ™ºæ…§é¡§å•ã€å†·éœæ±ºç­–è€…', 
                    localName:'å°ç£æ™ºæ…§å¥³ç¥', 
                    description:'ä½ æ˜¯å°ç£çš„æ™ºæ…§å¥³ç¥ï¼Œç”¨æ·±è¬€é æ…®æŒ‡å¼•æ–¹å‘ï¼'
                },
                other: { 
                    name:'æ™ºæ…§é¾œä»™ä½¿è€…', 
                    ability:'ğŸ¦¸ è¶…èƒ½åŠ›ï¼šå¤šå…ƒæ€è€ƒ + ç­–ç•¥å”èª¿ + å†·éœåˆ†æ', 
                    mission:'ğŸ¯ å°ˆå±¬ä»»å‹™ï¼šæ™ºæ…§æ©‹æ¨‘ã€ç­–ç•¥å”èª¿è€…ã€å¤šå…ƒé¡§å•', 
                    localName:'å°ç£æ™ºå›Šåœ˜', 
                    description:'ä½ æ˜¯å°ç£çš„æ™ºå›Šåœ˜ï¼Œç”¨å¤šå…ƒæ™ºæ…§è§£æ±ºè¤‡é›œå•é¡Œï¼'
                }
            }
        };

        // ========== åˆ†é æ¨¡å¼è®Šæ•¸ ==========
        let currentPage = 0;
        let questionsPerPage = 10; // é è¨­10é¡Œä¸€é 
        let totalPages = 0;
        let shuffledBANK = [];
        let radarChart = null;

        function initializeApp() {
            // è¨­å®šå ±å‘Šæ—¥æœŸ
            document.getElementById('report-date').textContent = new Date().toLocaleDateString('zh-TW', { 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric', 
                hour: '2-digit', 
                minute: '2-digit' 
            });

            // åˆå§‹åŒ–æ¸¬é©—é¡Œç›®ï¼ˆä½¿ç”¨åˆ†é æ¨¡å¼ï¼‰
            initializeQuestionsWithPagination();
            
            // åˆå§‹åŒ–è¨­å®šé¢æ¿
            initializeSettings();
            
            // åˆå§‹åŒ–äº‹ä»¶ç›£è½å™¨
            initializeEventListeners();
        }

        // ========== åˆ†é æ¨¡å¼åˆå§‹åŒ– ==========
        function initializeQuestionsWithPagination() {
            const questionPages = document.getElementById("questionPages");
            questionPages.innerHTML = '';
            
            // éš¨æ©Ÿæ’åºé¡Œç›®
            shuffledBANK = [...BANK].sort(() => 0.5 - Math.random());
            
            // æ ¹æ“šé¸æ“‡çš„æ¨¡å¼è¨­å®šæ¯é é¡Œæ•¸
            const pageMode = document.getElementById('pageModeSelect').value;
            if (pageMode === 'single') {
                questionsPerPage = 1;
            } else if (pageMode === 'multi10') {
                questionsPerPage = 10;
            } else {
                questionsPerPage = shuffledBANK.length; // å…¨éƒ¨é¡¯ç¤º
            }
            
            totalPages = Math.ceil(shuffledBANK.length / questionsPerPage);
            
            // å»ºç«‹åˆ†é 
            for (let pageIndex = 0; pageIndex < totalPages; pageIndex++) {
                const pageDiv = document.createElement('div');
                pageDiv.className = `question-page ${pageIndex === 0 ? 'active' : ''}`;
                pageDiv.id = `page-${pageIndex}`;
                
                let pageHTML = '';
                const startIndex = pageIndex * questionsPerPage;
                const endIndex = Math.min(startIndex + questionsPerPage, shuffledBANK.length);
                
                for (let i = startIndex; i < endIndex; i++) {
                    const question = shuffledBANK[i];
                    const questionNumber = i + 1;
                    pageHTML += `
                        <div class="mb-4 p-3 border rounded question-item" data-question-index="${i}">
                            <p class="font-medium mb-2">${questionNumber}. ${question.t}</p>
                            <div class="options grid grid-cols-5 gap-2">
                                <div class="option-card" data-value="1">1<br><span class="text-xs">ä¸åŒæ„</span></div>
                                <div class="option-card" data-value="2">2<br><span class="text-xs">æœ‰é»ä¸åŒæ„</span></div>
                                <div class="option-card" data-value="3">3<br><span class="text-xs">æ™®é€š</span></div>
                                <div class="option-card" data-value="4">4<br><span class="text-xs">æœ‰é»åŒæ„</span></div>
                                <div class="option-card" data-value="5">5<br><span class="text-xs">éå¸¸åŒæ„</span></div>
                            </div>
                        </div>
                    `;
                }
                
                pageDiv.innerHTML = pageHTML;
                questionPages.appendChild(pageDiv);
            }
            
            // æ›´æ–°åˆ†é æŒ‡ç¤ºå™¨
            updatePageIndicator();
            
            // ç‚ºé¸é …å¡ç‰‡æ·»åŠ äº‹ä»¶ç›£è½
            initializeOptionCards();
            
            // æ›´æ–°é€²åº¦
            updateProgress();
        }

        // ========== åˆå§‹åŒ–é¸é …å¡ç‰‡äº‹ä»¶ ==========
        function initializeOptionCards() {
            document.querySelectorAll('.option-card').forEach(card => {
                card.addEventListener('click', function() {
                    // ç§»é™¤åŒä¸€å•é¡Œä¸­æ‰€æœ‰é¸é …çš„é¸ä¸­ç‹€æ…‹
                    const parent = this.closest('.options');
                    parent.querySelectorAll('.option-card').forEach(c => {
                        c.classList.remove('selected');
                    });
                    
                    // è¨­å®šç•¶å‰é¸é …ç‚ºé¸ä¸­ç‹€æ…‹
                    this.classList.add('selected');
                    
                    // æ›´æ–°é€²åº¦
                    updateProgress();
                });
            });
        }

        // ========== æ›´æ–°åˆ†é æŒ‡ç¤ºå™¨ ==========
        function updatePageIndicator() {
            const pageMode = document.getElementById('pageModeSelect').value;
            
            // æ›´æ–°ä¸Šæ–¹æŒ‡ç¤ºå™¨
            document.getElementById('pageIndicator').textContent = `${currentPage + 1}/${totalPages}`;
            
            // æ›´æ–°ä¸‹æ–¹æŒ‡ç¤ºå™¨
            document.getElementById('pageIndicatorBottom').textContent = `ç¬¬ ${currentPage + 1} é ï¼Œå…± ${totalPages} é `;
            
            // æ›´æ–°æŒ‰éˆ•ç‹€æ…‹
            document.getElementById('prevPage').disabled = currentPage === 0;
            document.getElementById('nextPage').disabled = currentPage === totalPages - 1;
            document.getElementById('prevPageBottom').disabled = currentPage === 0;
            document.getElementById('nextPageBottom').disabled = currentPage === totalPages - 1;
            
            // å¦‚æœæ˜¯å…¨éƒ¨é¡¯ç¤ºæ¨¡å¼ï¼Œéš±è—åˆ†é æ§åˆ¶
            if (pageMode === 'all') {
                document.querySelector('.pagination-buttons').style.display = 'none';
                document.querySelector('.page-controls-bottom').style.display = 'none';
            } else {
                document.querySelector('.pagination-buttons').style.display = 'flex';
                document.querySelector('.page-controls-bottom').style.display = 'flex';
            }
        }

        // ========== æ›´æ–°é€²åº¦é¡¯ç¤º ==========
        function updateProgress() {
            const answered = document.querySelectorAll('.option-card.selected').length;
            const total = BANK.length;
            document.getElementById("progress").textContent = `${answered}/${total}`;
        }

        // ========== è¨­å®šé¢æ¿åˆå§‹åŒ– ==========
        function initializeSettings() {
            const savedSettings = JSON.parse(localStorage.getItem('reportContactSettings') || '{}');
            
            // è¨­å®šè¡¨å–®å€¼
            document.getElementById('pageMode').value = savedSettings.pageMode || 'multi10';
            document.getElementById('reportFontSize').value = savedSettings.reportFontSize || 'medium';
            
            // åŒæ­¥åˆ†é æ¨¡å¼é¸æ“‡å™¨
            document.getElementById('pageModeSelect').value = savedSettings.pageMode || 'multi10';
            document.getElementById('reportFontSizeSelect').value = savedSettings.reportFontSize || 'medium';
            
            // æ‡‰ç”¨å­—é«”å¤§å°
            applyReportFontSize(savedSettings.reportFontSize || 'medium');
        }

        // ========== äº‹ä»¶ç›£è½å™¨åˆå§‹åŒ– ==========
        function initializeEventListeners() {
            // è¨­å®šé¢æ¿é–‹é—œ
            document.getElementById('toggleSettingsBtn').addEventListener('click', function() {
                const settingsPanel = document.getElementById('reportSettingsForm');
                settingsPanel.classList.toggle('hidden');
            });
            
            // è¨­å®šè¡¨å–®æäº¤
            document.getElementById('reportSettingsForm').addEventListener('submit', function(e) {
                e.preventDefault();
                saveSettings();
            });
            
            // åˆ†é æ¨¡å¼é¸æ“‡ - ä¿®æ­£ï¼šç«‹å³é‡æ–°åˆå§‹åŒ–é¡Œç›®
            document.getElementById('pageModeSelect').addEventListener('change', function() {
                currentPage = 0;
                initializeQuestionsWithPagination();
            });
            
            // å ±è¡¨å­—é«”å¤§å°é¸æ“‡
            document.getElementById('reportFontSizeSelect').addEventListener('change', function() {
                applyReportFontSize(this.value);
            });
            
            // å¥—ç”¨å­—é«”å¤§å°æŒ‰éˆ•
            document.getElementById('applyFontSize').addEventListener('click', function() {
                applyReportFontSize(document.getElementById('reportFontSizeSelect').value);
            });
            
            // ä¸Šä¸€é æŒ‰éˆ• (ä¸Šæ–¹)
            document.getElementById('prevPage').addEventListener('click', function() {
                goToPreviousPage();
            });
            
            // ä¸‹ä¸€é æŒ‰éˆ• (ä¸Šæ–¹)
            document.getElementById('nextPage').addEventListener('click', function() {
                goToNextPage();
            });
            
            // ä¸Šä¸€é æŒ‰éˆ• (ä¸‹æ–¹)
            document.getElementById('prevPageBottom').addEventListener('click', function() {
                goToPreviousPage();
            });
            
            // ä¸‹ä¸€é æŒ‰éˆ• (ä¸‹æ–¹)
            document.getElementById('nextPageBottom').addEventListener('click', function() {
                goToNextPage();
            });
            
            // æ¸¬é©—è¡¨å–®æäº¤
            document.getElementById('form').addEventListener('submit', function(e) {
                e.preventDefault();
                submitQuiz();
            });
            
            // å…¨éƒ¨å¡«3æŒ‰éˆ•
            document.getElementById('btnFillMid').addEventListener('click', function() {
                document.querySelectorAll('.question-item').forEach(questionItem => {
                    const options = questionItem.querySelector('.options');
                    const option3 = options.querySelector('.option-card[data-value="3"]');
                    if (option3) {
                        options.querySelectorAll('.option-card').forEach(card => {
                            card.classList.remove('selected');
                        });
                        option3.classList.add('selected');
                    }
                });
                updateProgress();
            });
            
            // AIåˆ†ææŒ‰éˆ•
            document.getElementById('btnAI').addEventListener('click', function() {
                generateAIAnalysis();
            });
            
            // åˆ†äº«æŒ‰éˆ•
            document.getElementById('btnShare').addEventListener('click', function() {
                shareResult();
            });
        }

        // ========== åˆ†é å°èˆªå‡½æ•¸ ==========
        function goToPreviousPage() {
            if (currentPage > 0) {
                document.getElementById(`page-${currentPage}`).classList.remove('active');
                currentPage--;
                document.getElementById(`page-${currentPage}`).classList.add('active');
                updatePageIndicator();
                // æ»¾å‹•åˆ°é ‚éƒ¨
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }
        }

        function goToNextPage() {
            if (currentPage < totalPages - 1) {
                document.getElementById(`page-${currentPage}`).classList.remove('active');
                currentPage++;
                document.getElementById(`page-${currentPage}`).classList.add('active');
                updatePageIndicator();
                // æ»¾å‹•åˆ°é ‚éƒ¨
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }
        }

        // ========== å ±è¡¨å­—é«”å¤§å°æ‡‰ç”¨ ==========
        function applyReportFontSize(size) {
            const sizes = {
                'small': { body: '14px', h1: '2em', h2: '1.5em', card: '13px' },
                'medium': { body: '16px', h1: '2.5em', h2: '1.8em', card: '14px' },
                'large': { body: '18px', h1: '2.8em', h2: '2em', card: '15px' },
                'xlarge': { body: '20px', h1: '3em', h2: '2.2em', card: '16px' }
            };
            
            const selectedSize = sizes[size] || sizes.medium;
            
            // æ‡‰ç”¨å­—é«”å¤§å°åˆ°çµæœå€åŸŸ
            const resultSection = document.getElementById('result');
            if (resultSection) {
                resultSection.style.fontSize = selectedSize.body;
            }
            
            const aiReport = document.getElementById('aiReport');
            if (aiReport) {
                aiReport.style.fontSize = selectedSize.body;
            }
            
            const superheroReport = document.getElementById('superheroReport');
            if (superheroReport) {
                superheroReport.style.fontSize = selectedSize.body;
            }
            
            // å„²å­˜è¨­å®š
            const savedSettings = JSON.parse(localStorage.getItem('reportContactSettings') || '{}');
            savedSettings.reportFontSize = size;
            localStorage.setItem('reportContactSettings', JSON.stringify(savedSettings));
        }

        // ========== è¨­å®šç›¸é—œå‡½æ•¸ ==========
        function saveSettings() {
            const settings = {
                pageMode: document.getElementById('pageMode').value,
                reportFontSize: document.getElementById('reportFontSize').value
            };
            
            localStorage.setItem('reportContactSettings', JSON.stringify(settings));
            
            // åŒæ­¥æ›´æ–°åˆ†é æ¨¡å¼é¸æ“‡å™¨
            document.getElementById('pageModeSelect').value = settings.pageMode;
            document.getElementById('reportFontSizeSelect').value = settings.reportFontSize;
            
            // é‡æ–°åˆå§‹åŒ–é¡Œç›®åˆ†é 
            currentPage = 0;
            initializeQuestionsWithPagination();
            
            // æ‡‰ç”¨å­—é«”å¤§å°
            applyReportFontSize(settings.reportFontSize);
            
            alert('è¨­å®šå·²å„²å­˜ï¼');
        }

        // ========== æ¸¬é©—ç›¸é—œå‡½æ•¸ ==========
        function submitQuiz() {
            const scores = {é’é¾:0, æœ±é›€:0, å‹¾é™³:0, è£è›‡:0, ç™½è™:0, ç„æ­¦:0};
            
            // æ”¶é›†æ‰€æœ‰å·²å›ç­”çš„é—®é¢˜
            const answeredQuestions = document.querySelectorAll('.option-card.selected');
            
            if (answeredQuestions.length < BANK.length) {
                alert(`è«‹å®Œæˆæ‰€æœ‰é¡Œç›®ï¼ç›®å‰å·²å®Œæˆ ${answeredQuestions.length}/${BANK.length} é¡Œ`);
                return;
            }
            
            // è¨ˆç®—åˆ†æ•¸ - æ ¹æ“šå•é¡Œç´¢å¼•å°æ‡‰åˆ°åŸå§‹BANK
            document.querySelectorAll('.question-item').forEach(questionItem => {
                const questionIndex = parseInt(questionItem.getAttribute('data-question-index'));
                const selectedOption = questionItem.querySelector('.option-card.selected');
                
                if (selectedOption && questionIndex < shuffledBANK.length) {
                    const scoreValue = parseInt(selectedOption.getAttribute('data-value'));
                    const question = shuffledBANK[questionIndex];
                    scores[question.b] += scoreValue;
                }
            });
            
            const summary = summarize(scores);
            window.currentBeastType = summary.top;
            
            // é¡¯ç¤ºçµæœ
            renderRadar(scores);
            renderReport(summary, scores);
            
            // å„²å­˜çµæœ
            const gender = document.querySelector('input[name="gender"]:checked').value;
            localStorage.setItem("shen-shou-result", JSON.stringify({
                scores: scores,
                summary: summary,
                gender: gender
            }));
            
            document.getElementById("result").style.display = "grid";
            document.getElementById("aiReport").style.display = "block";
            document.getElementById("superheroReport").style.display = "block";
            
            showSuperhero(summary.top);
        }

        // ========== è¶…äººé¡¯ç¤ºå‡½æ•¸ ==========
        function showSuperhero(beastType) {
            const gender = document.querySelector('input[name="gender"]:checked').value;
            const beastData = superheroData[beastType];
            
            if (beastData) {
                const genderData = beastData[gender] || beastData.male;
                
                document.getElementById("superhero-name").textContent = genderData.name;
                document.getElementById("superhero-ability").textContent = genderData.ability;
                document.getElementById("superhero-mission").textContent = genderData.mission;
                document.getElementById("superhero-local").textContent = `ğŸ® å°ç£åœ¨åœ°ç‰ˆï¼š${genderData.localName} - ${genderData.description}`;
                
                // è¨­ç½®ç¥ç¸é¡¯ç¤º
                const superheroBeast = document.getElementById("superhero-beast");
                superheroBeast.textContent = beastType;
                
                // é¡¯ç¤ºè¶…äººå ±å‘Šå€å¡Š
                document.getElementById("superheroReport").style.display = "block";
            }
        }

        // ========== AIåˆ†æåŠŸèƒ½ ==========
        async function generateAIAnalysis() {
            const saved = JSON.parse(localStorage.getItem("shen-shou-result") || "null");
            if (!saved) {
                alert("âš ï¸è«‹å…ˆå®Œæˆæ¸¬é©—ã€‚");
                return;
            }

            const loadingEl = document.getElementById("ai-loading");
            const contentEl = document.getElementById("ai-analysis-content");
            const btnAI = document.getElementById("btnAI");
            const btnRetry = document.getElementById("btnRetry");
            
            loadingEl.style.display = "block";
            contentEl.style.display = "none";
            btnRetry.style.display = "none";
            btnAI.disabled = true;

            try {
                // é¡¯ç¤ºåˆ†æé€²åº¦
                simulateProgress();
                
                // æº–å‚™è«‹æ±‚è³‡æ–™
                const requestData = {
                    scores: saved.scores,
                    summary: saved.summary,
                    gender: saved.gender,
                    questions: BANK // å‚³é€é¡Œåº«è³‡æ–™ä¾›åˆ†æä½¿ç”¨
                };
                
                // å‘¼å«å¾Œç«¯ API
                const analysis = await callBackendAPI(requestData);
                
                // é¡¯ç¤ºåˆ†æçµæœ
                displayAIAnalysis(analysis);
                
            } catch (error) {
                console.error('AIåˆ†æéŒ¯èª¤:', error);
                alert('AIåˆ†æå¤±æ•—ï¼š' + error.message);
                
                // å¦‚æœAPIå¤±æ•—ï¼Œæä¾›æ¨¡æ“¬åˆ†æä½œç‚ºå‚™ç”¨
                const fallbackAnalysis = await simulateAIAnalysis(saved);
                displayAIAnalysis(fallbackAnalysis);
                alert('ä½¿ç”¨å‚™ç”¨åˆ†ææ¨¡å¼ï¼Œéƒ¨åˆ†åŠŸèƒ½å¯èƒ½å—é™');
            } finally {
                loadingEl.style.display = "none";
                contentEl.style.display = "block";
                btnRetry.style.display = "inline-block";
                btnAI.disabled = false;
            }
        }

        // ========== å‘¼å«å¾Œç«¯ API ==========
        async function callBackendAPI(requestData) {
            const response = await fetch('/api/ai', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(requestData)
            });

            if (!response.ok) {
                const errorData = await response.json();
                throw new Error(errorData.error || 'APIè«‹æ±‚å¤±æ•—');
            }

            const data = await response.json();
            return data.analysis;
        }

        // ========== å‚™ç”¨æ¨¡æ“¬åˆ†æï¼ˆAPIå¤±æ•—æ™‚ä½¿ç”¨ï¼‰==========
        async function simulateAIAnalysis(saved) {
            return new Promise((resolve) => {
                setTimeout(() => {
                    const beastType = saved.summary.top;
                    const gender = saved.gender;
                    
                    // æ ¹æ“šç¥ç¸é¡å‹å’Œæ€§åˆ¥ç”Ÿæˆåˆ†æå…§å®¹
                    const analysis = {
                        personality: generatePersonalityAnalysis(beastType, gender),
                        strengths: generateStrengthsAnalysis(beastType),
                        career: generateCareerAnalysis(beastType),
                        relationships: generateRelationshipsAnalysis(beastType),
                        growth: generateGrowthAnalysis(beastType),
                        money: generateMoneyAnalysis(beastType)
                    };
                    
                    resolve(analysis);
                }, 2000);
            });
        }

        // ========== ç”Ÿæˆå„é¡åˆ†æå…§å®¹ ==========
        function generatePersonalityAnalysis(beastType, gender) {
            const personalities = {
                'é’é¾': 'ä½ å…·æœ‰è±å¯Œçš„å‰µé€ åŠ›å’Œéˆæ„Ÿï¼Œæ€ç¶­æ´»èºä¸”å–„æ–¼å‰µæ–°ã€‚ä½ çš„å¤§è…¦å°±åƒä¸€å€‹æ°¸ä¸æ¯ç«­çš„å‰µæ„æºæ³‰ï¼Œç¸½èƒ½æƒ³å‡ºè®“äººé©šè‰·çš„é»å­ã€‚',
                'æœ±é›€': 'ä½ å……æ»¿ç†±æƒ…èˆ‡æ„ŸæŸ“åŠ›ï¼Œæ˜¯å¤©ç”Ÿçš„æºé€šè€…å’Œæ¿€å‹µè€…ã€‚ä½ çš„æƒ…ç·’è±å¯Œä¸”çœŸèª ï¼Œèƒ½å¤ è¼•æ˜“æ‰“å‹•ä»–äººä¸¦å»ºç«‹æ·±åšçš„æƒ…æ„Ÿé€£çµã€‚',
                'å‹¾é™³': 'ä½ é‡è¦–ç©©å®šå’Œç§©åºï¼Œåšäº‹å¯é æœ‰æ¢ç†ã€‚ä½ æ˜¯åœ˜éšŠä¸­å …å¯¦çš„åŸºç¤åŠ›é‡ï¼Œç¸½èƒ½æä¾›ç©©å®šå¯é çš„æ”¯æŒã€‚',
                'è£è›‡': 'ä½ å…·æœ‰æ•éŠ³çš„è§€å¯ŸåŠ›å’Œæ´å¯ŸåŠ›ï¼Œå–„æ–¼ç†è§£ä»–äººå¿ƒæ€ã€‚ä½ èƒ½å¤ å·§å¦™å”èª¿ä¸åŒç«‹å ´ï¼Œæ˜¯äººéš›é—œä¿‚çš„æ½¤æ»‘åŠ‘ã€‚',
                'ç™½è™': 'ä½ è¡Œå‹•åŠ›å¼·ä¸”æœæ–·ï¼Œæ³¨é‡æ•ˆç‡å’Œçµæœã€‚åœ¨å£“åŠ›ä¸‹ä»èƒ½ä¿æŒæ¸…æ™°æ±ºç­–ï¼Œæ˜¯è§£æ±ºå•é¡Œçš„èƒ½æ‰‹ã€‚',
                'ç„æ­¦': 'ä½ æ€æ…®å‘¨å¯†ä¸”æ·±è¬€é æ…®ï¼Œæ“…é•·åˆ†æå’Œè¦åŠƒã€‚å…·æœ‰å†·éœçš„æ™ºæ…§èˆ‡è€å¿ƒï¼Œæ˜¯åœ˜éšŠçš„æ™ºå›Šåœ˜ã€‚'
            };
            
            return personalities[beastType] || 'ä½ å…·æœ‰ç¨ç‰¹çš„äººæ ¼ç‰¹è³ªï¼Œéœ€è¦é€²ä¸€æ­¥æ¢ç´¢ã€‚';
        }

        function generateStrengthsAnalysis(beastType) {
            const strengths = {
                'é’é¾': 'å‰µæ„ç™¼æƒ³ã€å¿«é€Ÿé©æ‡‰ã€çªç ´æ¡†æ¶ã€éˆæ„Ÿè±å¯Œã€å¤šå…ƒæ€è€ƒ',
                'æœ±é›€': 'æƒ…æ„Ÿè¡¨é”ã€äººéš›æºé€šã€åœ˜éšŠæ¿€å‹µã€å…¬é–‹æ¼”èªªã€ç†±æƒ…æ„ŸæŸ“',
                'å‹¾é™³': 'ç©©å®šå¯é ã€ç´°ç¯€æŒæ§ã€åŸ·è¡ŒåŠ›å¼·ã€è²¬ä»»æ„Ÿé‡ã€ç³»çµ±ç¶­è­·',
                'è£è›‡': 'æ´å¯Ÿäººå¿ƒã€å”èª¿èƒ½åŠ›ã€æ™‚æ©Ÿåˆ¤æ–·ã€æƒ…æ„Ÿç†è§£ã€é—œä¿‚ç¶­è­·',
                'ç™½è™': 'æ±ºç­–æœæ–·ã€è¡Œå‹•è¿…é€Ÿã€ç›®æ¨™å°å‘ã€å£“åŠ›æ‰¿å—ã€æ•ˆç‡å„ªåŒ–',
                'ç„æ­¦': 'æ·±åº¦æ€è€ƒã€ç­–ç•¥è¦åŠƒã€é‚è¼¯åˆ†æã€å†·éœåˆ¤æ–·ã€é•·é è¦–é‡'
            };
            
            return `ä½ çš„æ ¸å¿ƒèƒ½é‡å„ªå‹¢åŒ…æ‹¬ï¼š${strengths[beastType] || 'ç¨ç‰¹çš„å€‹äººå„ªå‹¢'}ã€‚é€™äº›èƒ½åŠ›è®“ä½ åœ¨ç‰¹å®šé ˜åŸŸè¡¨ç¾å‡ºè‰²ã€‚`;
        }

        function generateCareerAnalysis(beastType) {
            const careers = {
                'é’é¾': 'å‰µæ„ç”¢æ¥­ã€æ–°å‰µå…¬å¸ã€è¡ŒéŠ·ç­–åŠƒã€ç”¢å“é–‹ç™¼ã€è—è¡“å‰µä½œ',
                'æœ±é›€': 'æ•™è‚²åŸ¹è¨“ã€å…¬é—œè¡ŒéŠ·ã€å®¢æˆ¶æœå‹™ã€äººåŠ›è³‡æºã€è¡¨æ¼”è—è¡“',
                'å‹¾é™³': 'è¡Œæ”¿ç®¡ç†ã€è²¡å‹™æœƒè¨ˆã€å“è³ªç®¡æ§ã€å°ˆæ¡ˆç®¡ç†ã€ç³»çµ±ç¶­è­·',
                'è£è›‡': 'å¿ƒç†è«®å•†ã€äººåŠ›è³‡æºã€å”èª¿æºé€šã€ç­–ç•¥åˆ†æã€å±æ©Ÿè™•ç†',
                'ç™½è™': 'æ¥­å‹™éŠ·å”®ã€å°ˆæ¡ˆé ˜å°ã€ç·Šæ€¥æ‡‰è®Šã€æ•ˆç‡å„ªåŒ–ã€æ±ºç­–ç®¡ç†',
                'ç„æ­¦': 'ç ”ç©¶é–‹ç™¼ã€æ•¸æ“šåˆ†æã€ç­–ç•¥è¦åŠƒã€æŠ€è¡“é¡§å•ã€å­¸è¡“ç ”ç©¶'
            };
            
            return `é©åˆä½ çš„è·å ´æ–¹å‘ï¼š${careers[beastType] || 'å¤šå…ƒç™¼å±•é ˜åŸŸ'}ã€‚åœ¨é€™äº›é ˜åŸŸä¸­ï¼Œä½ çš„å¤©è³¦å°‡å¾—åˆ°å……åˆ†ç™¼æ®ã€‚`;
        }

        function generateRelationshipsAnalysis(beastType) {
            const relationships = {
                'é’é¾': 'åœ¨äººéš›é—œä¿‚ä¸­ï¼Œä½ å¸¶çµ¦ä»–äººæ–°é®®æ„Ÿå’Œå‰µæ„å•Ÿç™¼ï¼Œä½†éœ€è¦æ³¨æ„é©æ™‚å‚¾è½ä»–äººçš„æƒ³æ³•ã€‚',
                'æœ±é›€': 'ä½ æ“…é•·å»ºç«‹æº«æš–çš„æƒ…æ„Ÿé€£çµï¼Œä½†è¦é¿å…éåº¦æƒ…ç·’åŒ–å½±éŸ¿ç†æ€§åˆ¤æ–·ã€‚',
                'å‹¾é™³': 'ä½ çµ¦äººå¯é ç©©å®šçš„æ„Ÿè¦ºï¼Œä½†æœ‰æ™‚éœ€è¦å±•ç¾æ›´å¤šå½ˆæ€§å’Œè®Šé€šæ€§ã€‚',
                'è£è›‡': 'ä½ èƒ½æ•éŠ³å¯Ÿè¦ºä»–äººéœ€æ±‚ï¼Œä½†è¦å°å¿ƒä¸è¦éåº¦è§£è®€æˆ–æ‰¿æ“”éå¤šæƒ…ç·’è² æ“”ã€‚',
                'ç™½è™': 'ä½ çš„ç›´æ¥å’Œæ•ˆç‡å—äººæ¬£è³ï¼Œä½†éœ€è¦æ³¨æ„è¡¨é”æ–¹å¼ï¼Œé¿å…çµ¦äººå£“è¿«æ„Ÿã€‚',
                'ç„æ­¦': 'ä½ çš„å†·éœå’Œæ™ºæ…§è®“äººä¿¡è³´ï¼Œä½†è¦é©æ™‚è¡¨é”æƒ…æ„Ÿï¼Œé¿å…é¡¯å¾—éæ–¼ç–é›¢ã€‚'
            };
            
            return relationships[beastType] || 'åœ¨äººéš›äº’å‹•ä¸­ä¿æŒå¹³è¡¡ï¼Œç™¼æ®å„ªå‹¢çš„åŒæ™‚æ³¨æ„æ½›åœ¨ç›²é»ã€‚';
        }

        function generateGrowthAnalysis(beastType) {
            const growth = {
                'é’é¾': 'å­¸ç¿’å°‡å‰µæ„è½å¯¦ç‚ºå…·é«”è¡Œå‹•ï¼Œå»ºç«‹æŒçºŒåŸ·è¡Œçš„ç¿’æ…£ï¼Œé¿å…æƒ³æ³•å¤ªå¤šè€Œç¼ºä¹æ·±åº¦ã€‚',
                'æœ±é›€': 'ç™¼å±•ç†æ€§åˆ†æèƒ½åŠ›ï¼Œåœ¨æƒ…æ„Ÿè¡¨é”çš„åŒæ™‚ä¿æŒå®¢è§€åˆ¤æ–·ï¼Œå­¸ç¿’æƒ…ç·’ç®¡ç†æŠ€å·§ã€‚',
                'å‹¾é™³': 'å˜—è©¦æ¥å—æ›´å¤šä¸ç¢ºå®šæ€§ï¼ŒåŸ¹é¤Šå‰µæ–°æ€ç¶­ï¼Œåœ¨ç©©å®šä¸­å°‹æ±‚é©åº¦çªç ´ã€‚',
                'è£è›‡': 'å»ºç«‹å€‹äººç•Œé™ï¼Œé¿å…éåº¦æ‰¿æ“”ä»–äººæƒ…ç·’ï¼Œå­¸ç¿’é©æ™‚è¡¨é”è‡ªå·±çš„éœ€æ±‚ã€‚',
                'ç™½è™': 'åŸ¹é¤Šè€å¿ƒå’Œç´°å¿ƒï¼Œåœ¨è¿½æ±‚æ•ˆç‡çš„åŒæ™‚æ³¨é‡éç¨‹å“è³ªï¼Œå­¸ç¿’åœ˜éšŠå”ä½œæŠ€å·§ã€‚',
                'ç„æ­¦': 'åŠ å¼·è¡Œå‹•åŠ›å’Œæ±ºæ–·åŠ›ï¼Œåœ¨æ·±æ€ç†Ÿæ…®å¾Œå‹‡æ•¢å¯¦è¸ï¼Œå­¸ç¿’æ›´ç›´æ¥çš„æƒ…æ„Ÿè¡¨é”ã€‚'
            };
            
            return growth[beastType] || 'æŒçºŒè‡ªæˆ‘è¦ºå¯Ÿï¼Œåœ¨å„ªå‹¢åŸºç¤ä¸Šç™¼å±•äº’è£œèƒ½åŠ›ï¼Œå¯¦ç¾æ›´å…¨é¢çš„æˆé•·ã€‚';
        }

        function generateMoneyAnalysis(beastType) {
            const money = {
                'é’é¾': 'é‡‘éŒ¢å¦è±¡é¡¯ç¤ºä½ æœ‰å‰µæ–°æ±‚è²¡çš„æ½›åŠ›ï¼Œé©åˆæŠ•è³‡æ–°èˆˆé ˜åŸŸï¼Œä½†éœ€æ³¨æ„é¢¨éšªæ§åˆ¶ã€‚',
                'æœ±é›€': 'ä½ çš„äººéš›ç¶²çµ¡æ˜¯é‡è¦è²¡æºï¼Œé€éåˆä½œèˆ‡åˆ†äº«å¯å‰µé€ æ›´å¤šåƒ¹å€¼ï¼Œæ³¨æ„ç†æ€§æ¶ˆè²»ã€‚',
                'å‹¾é™³': 'ç©©å®šç©ç´¯æ˜¯ä½ çš„è²¡å¯Œä¹‹é“ï¼Œé•·æœŸæŠ•è³‡å’Œå„²è“„è¨ˆåŠƒæœ€é©åˆä½ ï¼Œé¿å…æŠ•æ©Ÿå¿ƒæ…‹ã€‚',
                'è£è›‡': 'ä½ æ“…é•·ç™¼ç¾éš±è—æ©Ÿæœƒï¼Œæ™‚æ©Ÿåˆ¤æ–·ç²¾æº–ï¼Œä½†éœ€é¿å…éåº¦çŒ¶è±«éŒ¯å¤±è‰¯æ©Ÿã€‚',
                'ç™½è™': 'è¡Œå‹•åŠ›å¸¶ä¾†è²¡å¯Œå¢é•·ï¼Œå¿«é€Ÿæ±ºç­–å’ŒåŸ·è¡Œæ˜¯ä½ çš„å„ªå‹¢ï¼Œæ³¨æ„é¿å…è¡å‹•æŠ•è³‡ã€‚',
                'ç„æ­¦': 'æ·±åº¦åˆ†æå’Œé•·é è¦åŠƒæ˜¯ä½ çš„è‡´å¯Œé—œéµï¼ŒçŸ¥è­˜è®Šç¾æ½›åŠ›å¤§ï¼Œéœ€åŠ å¼·è¡Œå‹•è½å¯¦ã€‚'
            };
            
            return money[beastType] || 'æ ¹æ“šäº”è¡Œé‡‘éŒ¢å¦è§£æï¼Œä½ çš„è²¡å¯Œèƒ½é‡éœ€è¦å¹³è¡¡ç™¼å±•ï¼Œæ³¨é‡é•·æœŸç©©å®šèˆ‡é©åº¦å†’éšªçš„çµåˆã€‚';
        }

        // ========== é¡¯ç¤ºAIåˆ†æçµæœ ==========
        function displayAIAnalysis(analysis) {
            const {
                personality = '',
                strengths = '',
                career = '',
                relationships = '',
                growth = '',
                money = ''
            } = analysis;

            // é¡¯ç¤ºåˆ°å°æ‡‰çš„å€å¡Š
            document.getElementById("ai-personality").innerHTML = formatAIContent(personality);
            document.getElementById("ai-strengths").innerHTML = formatAIContent(strengths);
            document.getElementById("ai-career").innerHTML = formatAIContent(career);
            document.getElementById("ai-relationships").innerHTML = formatAIContent(relationships);
            document.getElementById("ai-growth").innerHTML = formatAIContent(growth);
            document.getElementById("ai-money").innerHTML = formatAIContent(money);
        }

        // ========== æ ¼å¼åŒ–AIå…§å®¹ ==========
        function formatAIContent(content) {
            if (!content) return '<div class="text-gray-500 text-center py-3">æš«ç„¡åˆ†æå…§å®¹</div>';
            
            // ç°¡å–®çš„æ ¼å¼åŒ–è™•ç†
            return content.split('\n')
                .filter(line => line.trim())
                .map(line => {
                    if (line.match(/^[â€¢\-]/)) {
                        return `<div style="margin: 8px 0; padding-left: 10px;">${line}</div>`;
                    }
                    return `<p style="margin: 12px 0; line-height: 1.6;">${line}</p>`;
                })
                .join('');
        }

        function simulateProgress() {
            const progressBar = document.getElementById("progress-bar");
            const loadingStep = document.getElementById("loading-step");
            const steps = [
                {percent: 20, text: "åˆ†æäººæ ¼ç‰¹è³ª..."},
                {percent: 40, text: "è§£æèƒ½é‡åˆ†å¸ƒ..."},
                {percent: 60, text: "ç”Ÿæˆç™¼å±•å»ºè­°..."},
                {percent: 80, text: "è¨ˆç®—äº”è¡Œé‡‘éŒ¢å¦..."},
                {percent: 95, text: "æœ€çµ‚æ•´åˆå ±å‘Š..."},
                {percent: 100, text: "åˆ†æå®Œæˆï¼"}
            ];
            
            let currentStep = 0;
            const interval = setInterval(() => {
                if (currentStep < steps.length) {
                    progressBar.style.width = steps[currentStep].percent + "%";
                    loadingStep.textContent = steps[currentStep].text;
                    currentStep++;
                } else {
                    clearInterval(interval);
                }
            }, 500);
        }

        // ========== å…¶é¤˜å‡½æ•¸ ==========
        function summarize(scores) {
            const entries = Object.entries(scores).sort((a, b) => b[1] - a[1]);
            const top = entries[0];
            const secondary = entries[1];
            const dual = top[1] - secondary[1] <= 2 ? [top[0], secondary[0]] : null;
            
            const total = Object.values(scores).reduce((sum, score) => sum + score, 0);
            const variantIndex = total % 12;
            const variants = ["å­","ä¸‘","å¯…","å¯","è¾°","å·³","åˆ","æœª","ç”³","é…‰","æˆŒ","äº¥"];
            
            return {
                top: top[0],
                dual: dual,
                ranking: entries,
                variant: variants[variantIndex],
                total: total,
                scores: scores
            };
        }

        function renderRadar(scores) {
            const canvas = document.getElementById("radar");
            if (radarChart) {
                radarChart.destroy();
            }
            
            radarChart = new Chart(canvas, {
                type: "radar",
                data: {
                    labels: Object.keys(scores),
                    datasets: [{
                        label: "å…­ç¸èƒ½é‡",
                        data: Object.values(scores),
                        backgroundColor: "rgba(182,130,43,0.15)",
                        borderColor: "#b6822b",
                        pointBackgroundColor: "#b6822b",
                        pointBorderColor: "#fff",
                        pointHoverBackgroundColor: "#fff",
                        pointHoverBorderColor: "#b6822b"
                    }]
                },
                options: {
                    scales: {
                        r: {
                            beginAtZero: true,
                            max: 25,
                            ticks: {
                                stepSize: 5
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    elements: {
                        line: {
                            borderWidth: 2
                        }
                    }
                }
            });
        }

        function renderReport(summary, scores) {
            const beastTitles = {
                'é’é¾': 'å‰µæ„éˆæ„Ÿå‹',
                'æœ±é›€': 'ç†±æƒ…è¡¨é”å‹', 
                'å‹¾é™³': 'ç©©å›ºå¯é å‹',
                'è£è›‡': 'æ´å¯Ÿå”èª¿å‹',
                'ç™½è™': 'è¡Œå‹•æ±ºæ–·å‹',
                'ç„æ­¦': 'æ™ºæ…§è¦åŠƒå‹'
            };
            
            const beastDescriptions = {
                'é’é¾': 'ä½ æ“æœ‰è±å¯Œçš„å‰µé€ åŠ›å’Œéˆæ„Ÿï¼Œå–„æ–¼çªç ´å‚³çµ±æ¡†æ¶ï¼Œåœ¨è®Šå‹•ä¸­å°‹æ‰¾æ©Ÿæœƒã€‚',
                'æœ±é›€': 'ä½ å……æ»¿ç†±æƒ…èˆ‡æ„ŸæŸ“åŠ›ï¼Œæ“…é•·è¡¨é”å’Œæºé€šï¼Œèƒ½å¤ æ¿€å‹µä»–äººä¸¦å»ºç«‹è‰¯å¥½é—œä¿‚ã€‚',
                'å‹¾é™³': 'ä½ é‡è¦–ç©©å®šå’Œç§©åºï¼Œåšäº‹å¯é æœ‰æ¢ç†ï¼Œæ˜¯åœ˜éšŠä¸­å …å¯¦çš„åŸºç¤åŠ›é‡ã€‚',
                'è£è›‡': 'ä½ å…·æœ‰æ•éŠ³çš„è§€å¯ŸåŠ›ï¼Œå–„æ–¼ç†è§£ä»–äººå¿ƒæ€ï¼Œèƒ½å¤ å·§å¦™å”èª¿ä¸åŒç«‹å ´ã€‚',
                'ç™½è™': 'ä½ è¡Œå‹•åŠ›å¼·ä¸”æœæ–·ï¼Œæ³¨é‡æ•ˆç‡å’Œçµæœï¼Œåœ¨å£“åŠ›ä¸‹ä»èƒ½ä¿æŒæ¸…æ™°æ±ºç­–ã€‚',
                'ç„æ­¦': 'ä½ æ€æ…®å‘¨å¯†ä¸”æ·±è¬€é æ…®ï¼Œæ“…é•·åˆ†æå’Œè¦åŠƒï¼Œå…·æœ‰å†·éœçš„æ™ºæ…§èˆ‡è€å¿ƒã€‚'
            };
            
            const adviceData = {
                'é’é¾': {
                    'å„ªå‹¢': 'ç™¼æ®å‰µæ„ï¼Œæå‡ºæ–°é»å­',
                    'æ³¨æ„': 'é¿å…æƒ³æ³•å¤ªå¤šç¼ºä¹åŸ·è¡Œ',
                    'ç™¼å±•': 'å­¸ç¿’å°‡éˆæ„Ÿè½å¯¦ç‚ºå…·é«”è¨ˆåŠƒ'
                },
                'æœ±é›€': {
                    'å„ªå‹¢': 'é‹ç”¨ç†±æƒ…æ„ŸæŸ“åœ˜éšŠ',
                    'æ³¨æ„': 'é¿å…æƒ…ç·’æ³¢å‹•å½±éŸ¿åˆ¤æ–·',
                    'ç™¼å±•': 'å­¸ç¿’ç†æ€§åˆ†æå¹³è¡¡æƒ…æ„Ÿ'
                },
                'å‹¾é™³': {
                    'å„ªå‹¢': 'å»ºç«‹ç©©å®šå¯é ç³»çµ±',
                    'æ³¨æ„': 'é¿å…éåº¦ä¿å®ˆç¼ºä¹å½ˆæ€§',
                    'ç™¼å±•': 'å˜—è©¦é©åº¦å‰µæ–°èˆ‡æ”¹è®Š'
                },
                'è£è›‡': {
                    'å„ªå‹¢': 'æ´å¯Ÿäººå¿ƒå”èª¿é—œä¿‚',
                    'æ³¨æ„': 'é¿å…éåº¦è§£è®€ä»–äººæ„åœ–',
                    'ç™¼å±•': 'å»ºç«‹æ¸…æ™°å€‹äººç•Œé™'
                },
                'ç™½è™': {
                    'å„ªå‹¢': 'å¿«é€Ÿæ±ºç­–é«˜æ•ˆåŸ·è¡Œ',
                    'æ³¨æ„': 'é¿å…è¡å‹•å¿½ç•¥ç´°ç¯€',
                    'ç™¼å±•': 'åŸ¹é¤Šè€å¿ƒèˆ‡åœ˜éšŠå”ä½œ'
                },
                'ç„æ­¦': {
                    'å„ªå‹¢': 'æ·±åº¦æ€è€ƒé•·é è¦åŠƒ',
                    'æ³¨æ„': 'é¿å…éåº¦åˆ†æå»¶èª¤è¡Œå‹•',
                    'ç™¼å±•': 'åŠ å¼·æ±ºæ–·åŠ›èˆ‡åŸ·è¡ŒåŠ›'
                }
            };
            
            // é¡¯ç¤ºä¸»å‹
            document.getElementById("beastSimple").textContent = summary.top;
            document.getElementById("mainBeastTitle").textContent = 
                `${summary.top}ãƒ»${beastTitles[summary.top]}ãƒ»${summary.variant}å‹`;
            document.getElementById("mainBeastSummary").textContent = beastDescriptions[summary.top];
            
            // é¡¯ç¤ºé›™é‡æç¤º
            if (summary.dual) {
                document.getElementById("dualHint").textContent = 
                    `â€» æ³¨æ„ï¼šæ‚¨æœ‰${summary.dual[0]}+${summary.dual[1]}é›™é‡ç‰¹è³ªå‚¾å‘`;
            } else {
                document.getElementById("dualHint").textContent = "";
            }
            
            // é¡¯ç¤ºä¸‰æ¬„å»ºè­°
            const advice = adviceData[summary.top];
            const adviceCols = document.getElementById("adviceCols");
            adviceCols.innerHTML = `
                <div class="p-3 bg-green-50 rounded-lg">
                    <div class="font-bold text-green-700 mb-1">å„ªå‹¢ç™¼æ®</div>
                    <div class="text-sm">${advice.å„ªå‹¢}</div>
                </div>
                <div class="p-3 bg-amber-50 rounded-lg">
                    <div class="font-bold text-amber-700 mb-1">æ³¨æ„æé†’</div>
                    <div class="text-sm">${advice.æ³¨æ„}</div>
                </div>
                <div class="p-3 bg-blue-50 rounded-lg">
                    <div class="font-bold text-blue-700 mb-1">ç™¼å±•æ–¹å‘</div>
                    <div class="text-sm">${advice.ç™¼å±•}</div>
                </div>
            `;
        }

        // ========== åˆ†äº«åŠŸèƒ½ ==========
        function shareResult() {
            alert('åˆ†äº«åŠŸèƒ½å³å°‡æ¨å‡ºï¼ç›®å‰è«‹ä½¿ç”¨åˆ—å°åŠŸèƒ½ä¿å­˜æ‚¨çš„æ¸¬é©—çµæœã€‚');
        }

        // ========== åˆ—å°åŠŸèƒ½ ==========
        function printAnalysis() {
            window.print();
        }
    </script>
</body>
</html>
